

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Data Reconciliation &mdash; Pyomo 6.5.1.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Covariance Matrix Estimation" href="covariance.html" />
    <link rel="prev" title="Parameter Estimation" href="driver.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Pyomo
          

          
          </a>

          
            
            
              <div class="version">
                6.5.1.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing_pyomo.html">Citing Pyomo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyomo_overview/index.html">Pyomo Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyomo_modeling_components/index.html">Pyomo Modeling Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solving_pyomo_models.html">Solving Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../working_models.html">Working with Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../working_abstractmodels/index.html">Working with Abstract Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_transformations/index.html">Model Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modeling_extensions/index.html">Modeling Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial_examples.html">Pyomo Tutorial Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_debugging/index.html">Debugging Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_topics/index.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../errors.html">Common Warnings/Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer_reference/index.html">Developer Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../library_reference/index.html">Library Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribution_guide.html">Contributing to Pyomo</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Third-Party Contributions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../community.html">Community Detection for Pyomo models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doe/doe.html">Pyomo.DoE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gdpopt.html">GDPopt logic-based solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iis.html">Infeasible Irreducible System (IIS) Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incidence/index.html">Incidence Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mindtpy.html">MindtPy Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mpc/index.html">MPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multistart.html">Multistart Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing.html">Nonlinear Preprocessing Transformations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Parameter Estimation with <code class="docutils literal notranslate"><span class="pre">parmest</span></code></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#citation-for-parmest">Citation for parmest</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#index-of-parmest-documentation">Index of parmest documentation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html">Installation Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="driver.html">Parameter Estimation</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Data Reconciliation</a></li>
<li class="toctree-l4"><a class="reference internal" href="covariance.html">Covariance Matrix Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="scencreate.html">Scenario Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="graphics.html">Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="parallel.html">Parallel Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#indices-and-tables">Indices and Tables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pynumero/index.html">PyNumero</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyros.html">PyROS Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sensitivity_toolbox.html">Sensitivity Toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trustregion.html">Trust Region Framework Method Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mcpp.html">MC++ Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../satsolver.html">z3 SMT Sat Solver Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../related_packages.html">Related Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Pyomo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Third-Party Contributions</a> &raquo;</li>
        
          <li><a href="index.html">Parameter Estimation with <code class="docutils literal notranslate"><span class="pre">parmest</span></code></a> &raquo;</li>
        
      <li>Data Reconciliation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/contributed_packages/parmest/datarec.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-reconciliation">
<span id="datarecsection"></span><h1>Data Reconciliation<a class="headerlink" href="#data-reconciliation" title="Permalink to this headline">¶</a></h1>
<p>The method <a class="reference internal" href="api.html#pyomo.contrib.parmest.parmest.Estimator.theta_est" title="pyomo.contrib.parmest.parmest.Estimator.theta_est"><code class="xref py py-class docutils literal notranslate"><span class="pre">theta_est</span></code></a>
can optionally return model values.  This feature can be used to return
reconciled data using a user specified objective. In this case, the list
of variable names the user wants to estimate (theta_names) is set to an
empty list and the objective function is defined to minimize
measurement to model error. Note that the model used for data
reconciliation may differ from the model used for parameter estimation.</p>
<p>The following example illustrates the use of parmest for data
reconciliation.  The functions
<a class="reference internal" href="api.html#pyomo.contrib.parmest.graphics.grouped_boxplot" title="pyomo.contrib.parmest.graphics.grouped_boxplot"><code class="xref py py-class docutils literal notranslate"><span class="pre">grouped_boxplot</span></code></a> or
<a class="reference internal" href="api.html#pyomo.contrib.parmest.graphics.grouped_violinplot" title="pyomo.contrib.parmest.graphics.grouped_violinplot"><code class="xref py py-class docutils literal notranslate"><span class="pre">grouped_violinplot</span></code></a> can be used
to visually compare the original and reconciled data.</p>
<p>Here’s a stylized code snippet showing how box plots might be created:</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyomo.contrib.parmest.parmest</span> <span class="k">as</span> <span class="nn">parmest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pest</span> <span class="o">=</span> <span class="n">parmest</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="n">model_function</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="p">[],</span> <span class="n">objective_function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">data_rec</span> <span class="o">=</span> <span class="n">pest</span><span class="o">.</span><span class="n">theta_est</span><span class="p">(</span><span class="n">return_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parmest</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">grouped_boxplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data_rec</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="returned-values">
<h2>Returned Values<a class="headerlink" href="#returned-values" title="Permalink to this headline">¶</a></h2>
<p>Here’s a full program that can be run to see returned values (in this case it
is the response function that is defined in the model file):</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyomo.contrib.parmest.parmest</span> <span class="k">as</span> <span class="nn">parmest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyomo.contrib.parmest.examples.rooney_biegler.rooney_biegler</span> <span class="kn">import</span> <span class="n">rooney_biegler_model</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;asymptote&#39;</span><span class="p">,</span> <span class="s1">&#39;rate_constant&#39;</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mf">8.3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mf">10.3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mf">19.0</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mf">16.0</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mf">15.6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mf">19.8</span><span class="p">]],</span>
<span class="gp">... </span>                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">SSE</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">expr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>\
<span class="gp">... </span>                <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">response_function</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">expr</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pest</span> <span class="o">=</span> <span class="n">parmest</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="n">rooney_biegler_model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">theta_names</span><span class="p">,</span> <span class="n">SSE</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">solver_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">var_values</span> <span class="o">=</span> <span class="n">pest</span><span class="o">.</span><span class="n">theta_est</span><span class="p">(</span><span class="n">return_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;response_function&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(var_values)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="covariance.html" class="btn btn-neutral float-right" title="Covariance Matrix Estimation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="driver.html" class="btn btn-neutral float-left" title="Parameter Estimation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2008-2023, Sandia National Laboratories.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>