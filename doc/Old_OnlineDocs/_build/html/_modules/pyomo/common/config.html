

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyomo.common.config &mdash; Pyomo 6.5.1.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Pyomo
          

          
          </a>

          
            
            
              <div class="version">
                6.5.1.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../citing_pyomo.html">Citing Pyomo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pyomo_overview/index.html">Pyomo Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pyomo_modeling_components/index.html">Pyomo Modeling Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../solving_pyomo_models.html">Solving Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_models.html">Working with Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_abstractmodels/index.html">Working with Abstract Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../model_transformations/index.html">Model Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modeling_extensions/index.html">Modeling Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial_examples.html">Pyomo Tutorial Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../model_debugging/index.html">Debugging Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_topics/index.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../errors.html">Common Warnings/Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_reference/index.html">Developer Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../library_reference/index.html">Library Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribution_guide.html">Contributing to Pyomo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributed_packages/index.html">Third-Party Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../related_packages.html">Related Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Pyomo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyomo.common.config</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyomo.common.config</h1><div class="highlight"><pre>
<span></span><span class="c1">#  ___________________________________________________________________________</span>
<span class="c1">#</span>
<span class="c1">#  Pyomo: Python Optimization Modeling Objects</span>
<span class="c1">#  Copyright (c) 2008-2022</span>
<span class="c1">#  National Technology and Engineering Solutions of Sandia, LLC</span>
<span class="c1">#  Under the terms of Contract DE-NA0003525 with National Technology and</span>
<span class="c1">#  Engineering Solutions of Sandia, LLC, the U.S. Government retains certain</span>
<span class="c1">#  rights in this software.</span>
<span class="c1">#  This software is distributed under the 3-clause BSD License.</span>
<span class="c1">#  ___________________________________________________________________________</span>
<span class="c1">#</span>
<span class="c1">#  This module was originally developed as part of the PyUtilib project</span>
<span class="c1">#  Copyright (c) 2008 Sandia Corporation.</span>
<span class="c1">#  This software is distributed under the BSD License.</span>
<span class="c1">#  Under the terms of Contract DE-AC04-94AL85000 with Sandia Corporation,</span>
<span class="c1">#  the U.S. Government retains certain rights in this software.</span>
<span class="c1">#  ___________________________________________________________________________</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">builtins</span>
<span class="kn">import</span> <span class="nn">enum</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">ply.lex</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">types</span>

<span class="kn">from</span> <span class="nn">pyomo.common.collections</span> <span class="kn">import</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Mapping</span>
<span class="kn">from</span> <span class="nn">pyomo.common.deprecation</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">deprecated</span><span class="p">,</span>
    <span class="n">deprecation_warning</span><span class="p">,</span>
    <span class="n">relocated_module_attribute</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyomo.common.errors</span> <span class="kn">import</span> <span class="n">DeveloperError</span>
<span class="kn">from</span> <span class="nn">pyomo.common.fileutils</span> <span class="kn">import</span> <span class="n">import_file</span>
<span class="kn">from</span> <span class="nn">pyomo.common.formatting</span> <span class="kn">import</span> <span class="n">wrap_reStructuredText</span>
<span class="kn">from</span> <span class="nn">pyomo.common.modeling</span> <span class="kn">import</span> <span class="n">NOTSET</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">relocated_module_attribute</span><span class="p">(</span>
    <span class="s1">&#39;PYOMO_CONFIG_DIR&#39;</span><span class="p">,</span> <span class="s1">&#39;pyomo.common.envvar.PYOMO_CONFIG_DIR&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.1&#39;</span>
<span class="p">)</span>

<span class="n">USER_OPTION</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">ADVANCED_OPTION</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">DEVELOPER_OPTION</span> <span class="o">=</span> <span class="mi">20</span>


<div class="viewcode-block" id="Bool"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.Bool">[docs]</a><span class="k">def</span> <span class="nf">Bool</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validator for bool-like objects.</span>

<span class="sd">    This is a more strict domain than ``bool``, as it will error on</span>
<span class="sd">    values that do not &quot;look&quot; like a Boolean value (i.e., it accepts</span>
<span class="sd">    ``True``, ``False``, 0, 1, and the case insensitive strings</span>
<span class="sd">    ``&#39;true&#39;``, ``&#39;false&#39;``, ``&#39;yes&#39;``, ``&#39;no&#39;``, ``&#39;t&#39;``, ``&#39;f&#39;``,</span>
<span class="sd">    ``&#39;y&#39;``, and ``&#39;n&#39;``)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">val</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;TRUE&#39;</span><span class="p">,</span> <span class="s1">&#39;YES&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">}:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;FALSE&#39;</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">}:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">}:</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected Boolean, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span></div>


<div class="viewcode-block" id="Integer"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.Integer">[docs]</a><span class="k">def</span> <span class="nf">Integer</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting integers</span>

<span class="sd">    This domain will admit integers, as well as any values that are</span>
<span class="sd">    &quot;reasonably exactly&quot; convertible to integers.  This is more strict</span>
<span class="sd">    than ``int``, as it will generate errors for floating point values</span>
<span class="sd">    that are not integer.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="c1"># We want to give an error for floating point numbers...</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected integer, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="PositiveInt"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.PositiveInt">[docs]</a><span class="k">def</span> <span class="nf">PositiveInt</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting strictly positive integers</span>

<span class="sd">    This domain will admit positive integers (n &gt; 0), as well as any</span>
<span class="sd">    types that are convertible to positive integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="c1"># We want to give an error for floating point numbers...</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ans</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected positive int, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NegativeInt"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NegativeInt">[docs]</a><span class="k">def</span> <span class="nf">NegativeInt</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting strictly negative integers</span>

<span class="sd">    This domain will admit negative integers (n &lt; 0), as well as any</span>
<span class="sd">    types that are convertible to negative integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ans</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected negative int, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NonPositiveInt"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NonPositiveInt">[docs]</a><span class="k">def</span> <span class="nf">NonPositiveInt</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting integers &lt;= 0</span>

<span class="sd">    This domain will admit non-positive integers (n &lt;= 0), as well as</span>
<span class="sd">    any types that are convertible to non-positive integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ans</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected non-positive int, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NonNegativeInt"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NonNegativeInt">[docs]</a><span class="k">def</span> <span class="nf">NonNegativeInt</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting integers &gt;= 0</span>

<span class="sd">    This domain will admit non-negative integers (n &gt;= 0), as well as</span>
<span class="sd">    any types that are convertible to non-negative integers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ans</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected non-negative int, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="PositiveFloat"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.PositiveFloat">[docs]</a><span class="k">def</span> <span class="nf">PositiveFloat</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting strictly positive numbers</span>

<span class="sd">    This domain will admit positive floating point numbers (n &gt; 0), as</span>
<span class="sd">    well as any types that are convertible to positive floating point</span>
<span class="sd">    numbers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected positive float, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NegativeFloat"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NegativeFloat">[docs]</a><span class="k">def</span> <span class="nf">NegativeFloat</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting strictly negative numbers</span>

<span class="sd">    This domain will admit negative floating point numbers (n &lt; 0), as</span>
<span class="sd">    well as any types that are convertible to negative floating point</span>
<span class="sd">    numbers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected negative float, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NonPositiveFloat"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NonPositiveFloat">[docs]</a><span class="k">def</span> <span class="nf">NonPositiveFloat</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting numbers less than or equal to 0</span>

<span class="sd">    This domain will admit non-positive floating point numbers (n &lt;= 0),</span>
<span class="sd">    as well as any types that are convertible to non-positive floating</span>
<span class="sd">    point numbers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected non-positive float, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="NonNegativeFloat"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.NonNegativeFloat">[docs]</a><span class="k">def</span> <span class="nf">NonNegativeFloat</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation function admitting numbers greater than or equal to 0</span>

<span class="sd">    This domain will admit non-negative floating point numbers (n &gt;= 0),</span>
<span class="sd">    as well as any types that are convertible to non-negative floating</span>
<span class="sd">    point numbers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ans</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected non-negative float, but received </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
    <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="In"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.In">[docs]</a><span class="k">class</span> <span class="nc">In</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;In(domain, cast=None)</span>
<span class="sd">    Domain validation class admitting a Container of possible values</span>

<span class="sd">    This will admit any value that is in the `domain` Container (i.e.,</span>
<span class="sd">    Container.__contains__() returns True).  Most common domains are</span>
<span class="sd">    list, set, and dict objects.  If specified, incoming values are</span>
<span class="sd">    first passed to `cast()` to convert them to the appropriate type</span>
<span class="sd">    before looking them up in `domain`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    domain: Container</span>
<span class="sd">        The container that specifies the allowable values.  Incoming</span>
<span class="sd">        values are passed to ``domain.__contains__()``, and if ``True``</span>
<span class="sd">        is returned, the value is accepted and returned.</span>

<span class="sd">    cast: Callable, optional</span>
<span class="sd">        A callable object.  If specified, incoming values are first</span>
<span class="sd">        passed to `cast`, and the resulting object is checked for</span>
<span class="sd">        membership in `domain`</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    For backwards compatibility, `In` accepts `enum.Enum` classes as</span>
<span class="sd">    `domain` Containers.  If the domain is an Enum, then the constructor</span>
<span class="sd">    returns an instance of `InEnum`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Convenience: enum.Enum supported __contains__ through Python</span>
        <span class="c1"># 3.7.  If the domain is an Enum and cast is not specified,</span>
        <span class="c1"># automatically return an InEnum to handle casting and validation</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">cls</span> <span class="ow">is</span> <span class="n">In</span>
            <span class="ow">and</span> <span class="n">cast</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">InEnum</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">In</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">cast</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span> <span class="o">=</span> <span class="n">cast</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;value </span><span class="si">%s</span><span class="s2"> not in domain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">domain_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_dn</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_dn</span> <span class="ow">or</span> <span class="n">_dn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;[({&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;In(</span><span class="si">{</span><span class="n">_dn</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;In</span><span class="si">{</span><span class="n">_dn</span><span class="si">}</span><span class="s1">&#39;</span></div>


<div class="viewcode-block" id="InEnum"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.InEnum">[docs]</a><span class="k">class</span> <span class="nc">InEnum</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validation class admitting an enum value/name.</span>

<span class="sd">    This will admit any value that is in the specified Enum, including</span>
<span class="sd">    Enum members, values, and string names.  The incoming value will be</span>
<span class="sd">    automatically cast to an Enum member.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    domain: enum.Enum</span>
<span class="sd">        The enum that incoming values should be mapped to</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">domain</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># First check if this is a valid enum value</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="c1"># Assume this is a string and look it up</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%r</span><span class="s2"> is not a valid </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">domain_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;InEnum[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">]&#39;</span></div>


<div class="viewcode-block" id="ListOf"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ListOf">[docs]</a><span class="k">class</span> <span class="nc">ListOf</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validator for lists of a specified type</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    itemtype: type</span>
<span class="sd">        The type for each element in the list</span>

<span class="sd">    domain: Callable</span>
<span class="sd">        A domain validator (callable that takes the incoming value,</span>
<span class="sd">        validates it, and returns the appropriate domain type) for each</span>
<span class="sd">        element in the list.  If not specified, defaults to the</span>
<span class="sd">        `itemtype`.</span>

<span class="sd">    string_lexer: Callable</span>
<span class="sd">        A preprocessor (lexer) called for all string values.  If</span>
<span class="sd">        NOTSET, then strings are split on whitespace and/or commas</span>
<span class="sd">        (honoring simple use of single or double quotes).  If None, then</span>
<span class="sd">        no tokenization is performed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemtype</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">string_lexer</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemtype</span> <span class="o">=</span> <span class="n">itemtype</span>
        <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemtype</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="k">if</span> <span class="n">string_lexer</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">string_lexer</span> <span class="o">=</span> <span class="n">_default_string_list_lexer</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">string_lexer</span> <span class="o">=</span> <span class="n">string_lexer</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;ListOf(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">),)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_lexer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">string_lexer</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">(</span><span class="n">value</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">domain_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_dn</span> <span class="o">=</span> <span class="n">_domain_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;ListOf[</span><span class="si">{</span><span class="n">_dn</span><span class="si">}</span><span class="s1">]&#39;</span></div>


<div class="viewcode-block" id="Module"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.Module">[docs]</a><span class="k">class</span> <span class="nc">Module</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validator for modules.</span>

<span class="sd">    Modules can be specified as module objects, by module name,</span>
<span class="sd">    or by the path to the module&#39;s file. If specified by path, the</span>
<span class="sd">    path string has the same path expansion features supported by</span>
<span class="sd">    the :py:class:`Path` class.</span>

<span class="sd">    Note that modules imported by file path may not be recognized as</span>
<span class="sd">    part of a package, and as such they should not use relative package</span>
<span class="sd">    importing (such as ``from . import foo``).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basePath : None, str, ConfigValue</span>
<span class="sd">        The base path that will be prepended to any non-absolute path</span>
<span class="sd">        values provided.  If None, defaults to :py:attr:`Path.BasePath`.</span>

<span class="sd">    expandPath : bool</span>
<span class="sd">        If True, then the value will be expanded and normalized.  If</span>
<span class="sd">        False, the string representation of the value will be used</span>
<span class="sd">        unchanged.  If None, expandPath will defer to the (negated)</span>
<span class="sd">        value of :py:attr:`Path.SuppressPathExpansion`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    The following code shows the three ways you can specify a module: by file</span>
<span class="sd">    name, by module name, or by module object. Regardless of how the module is</span>
<span class="sd">    specified, what is stored in the configuration is a module object.</span>

<span class="sd">    .. doctest::</span>

<span class="sd">        &gt;&gt;&gt; from pyomo.common.config import (</span>
<span class="sd">        ...     ConfigDict, ConfigValue, Module</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; config = ConfigDict()</span>
<span class="sd">        &gt;&gt;&gt; config.declare(&#39;my_module&#39;, ConfigValue(</span>
<span class="sd">        ...     domain=Module(),</span>
<span class="sd">        ... ))</span>
<span class="sd">        &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Set using file path</span>
<span class="sd">        &gt;&gt;&gt; config.my_module = &#39;../../pyomo/common/tests/config_plugin.py&#39;</span>
<span class="sd">        &gt;&gt;&gt; # Set using python module name, as a string</span>
<span class="sd">        &gt;&gt;&gt; config.my_module = &#39;os.path&#39;</span>
<span class="sd">        &gt;&gt;&gt; # Set using an imported module object</span>
<span class="sd">        &gt;&gt;&gt; import os.path</span>
<span class="sd">        &gt;&gt;&gt; config.my_module = os.path</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expandPath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basePath</span> <span class="o">=</span> <span class="n">basePath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expandPath</span> <span class="o">=</span> <span class="n">expandPath</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_id</span><span class="p">):</span>
        <span class="c1"># If it&#39;s already a module, just return it</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ismodule</span><span class="p">(</span><span class="n">module_id</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">module_id</span>

        <span class="c1"># Try to import it as a module</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">module_id</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ModuleNotFoundError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># This wasn&#39;t a module name</span>
            <span class="c1"># Ignore the exception and move on to path-based loading</span>
            <span class="k">pass</span>
        <span class="c1"># Any other kind of exception will be thrown out of this method</span>

        <span class="c1"># If we&#39;re still here, try loading by path</span>
        <span class="n">path_domain</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">basePath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expandPath</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path_domain</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">module_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">import_file</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="Path"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.Path">[docs]</a><span class="k">class</span> <span class="nc">Path</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validator for path-like options.</span>

<span class="sd">    This will admit any object and convert it to a string.  It will then</span>
<span class="sd">    expand any environment variables and leading usernames (e.g.,</span>
<span class="sd">    &quot;~myuser&quot; or &quot;~/&quot;) appearing in either the value or the base path</span>
<span class="sd">    before concatenating the base path and value, expanding the path to</span>
<span class="sd">    an absolute path, and normalizing the path.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basePath: None, str, ConfigValue</span>
<span class="sd">        The base path that will be prepended to any non-absolute path</span>
<span class="sd">        values provided.  If None, defaults to :py:attr:`Path.BasePath`.</span>

<span class="sd">    expandPath: bool</span>
<span class="sd">        If True, then the value will be expanded and normalized.  If</span>
<span class="sd">        False, the string representation of the value will be returned</span>
<span class="sd">        unchanged.  If None, expandPath will defer to the (negated)</span>
<span class="sd">        value of :py:attr:`Path.SuppressPathExpansion`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">BasePath</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">SuppressPathExpansion</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basePath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expandPath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">basePath</span> <span class="o">=</span> <span class="n">basePath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expandPath</span> <span class="o">=</span> <span class="n">expandPath</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">_expand</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expandPath</span>
        <span class="k">if</span> <span class="n">_expand</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_expand</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">Path</span><span class="o">.</span><span class="n">SuppressPathExpansion</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_expand</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">path</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">basePath</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">basePath</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">BasePath</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">base</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ConfigValue</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">base</span><span class="p">)</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>

        <span class="c1"># We want to handle the CWD variable ourselves.  It should</span>
        <span class="c1"># always be in a known location (the beginning of the string)</span>
        <span class="k">if</span> <span class="n">base</span> <span class="ow">and</span> <span class="n">base</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;$</span><span class="si">{cwd}</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">base</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">path</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;$</span><span class="si">{cwd}</span><span class="s1">&#39;</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">path</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>

        <span class="n">ans</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">base</span><span class="p">)),</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expandvars</span><span class="p">(</span><span class="n">path</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span></div>


<div class="viewcode-block" id="PathList"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.PathList">[docs]</a><span class="k">class</span> <span class="nc">PathList</span><span class="p">(</span><span class="n">Path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Domain validator for a list of path-like objects.</span>

<span class="sd">    This will admit any iterable or object convertible to a string.</span>
<span class="sd">    Iterable objects (other than strings) will have each member</span>
<span class="sd">    normalized using :py:class:`Path`.  Other types will be passed to</span>
<span class="sd">    :py:class:`Path`, returning a list with the single resulting path.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    basePath: Union[None, str, ConfigValue]</span>
<span class="sd">        The base path that will be prepended to any non-absolute path</span>
<span class="sd">        values provided.  If None, defaults to :py:attr:`Path.BasePath`.</span>

<span class="sd">    expandPath: bool</span>
<span class="sd">        If True, then the value will be expanded and normalized.  If</span>
<span class="sd">        False, the string representation of the value will be returned</span>
<span class="sd">        unchanged.  If None, expandPath will defer to the (negated)</span>
<span class="sd">        value of :py:attr:`Path.SuppressPathExpansion`</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;__iter__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">super</span><span class="p">(</span><span class="n">PathList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">super</span><span class="p">(</span><span class="n">PathList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">data</span><span class="p">)]</span></div>


<div class="viewcode-block" id="DynamicImplicitDomain"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.DynamicImplicitDomain">[docs]</a><span class="k">class</span> <span class="nc">DynamicImplicitDomain</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implicit domain that can return a custom domain based on the key.</span>

<span class="sd">    This provides a mechanism for managing plugin-like systems, where</span>
<span class="sd">    the key specifies a source for additional configuration information.</span>
<span class="sd">    For example, given the plugin module,</span>
<span class="sd">    ``pyomo/common/tests/config_plugin.py``:</span>

<span class="sd">    .. literalinclude:: /../../pyomo/common/tests/config_plugin.py</span>
<span class="sd">       :start-at: import</span>

<span class="sd">    .. doctest::</span>
<span class="sd">       :hide:</span>

<span class="sd">       &gt;&gt;&gt; import importlib</span>
<span class="sd">       &gt;&gt;&gt; import pyomo.common.fileutils</span>
<span class="sd">       &gt;&gt;&gt; from pyomo.common.config import ConfigDict, DynamicImplicitDomain</span>

<span class="sd">    .. doctest::</span>

<span class="sd">       &gt;&gt;&gt; def _pluginImporter(name, config):</span>
<span class="sd">       ...     mod = importlib.import_module(name)</span>
<span class="sd">       ...     return mod.get_configuration(config)</span>
<span class="sd">       &gt;&gt;&gt; config = ConfigDict()</span>
<span class="sd">       &gt;&gt;&gt; config.declare(&#39;plugins&#39;, ConfigDict(</span>
<span class="sd">       ...     implicit=True,</span>
<span class="sd">       ...     implicit_domain=DynamicImplicitDomain(_pluginImporter)))</span>
<span class="sd">       &lt;pyomo.common.config.ConfigDict object at ...&gt;</span>
<span class="sd">       &gt;&gt;&gt; config.plugins[&#39;pyomo.common.tests.config_plugin&#39;] = {&#39;key1&#39;: 5}</span>
<span class="sd">       &gt;&gt;&gt; config.display()</span>
<span class="sd">       plugins:</span>
<span class="sd">         pyomo.common.tests.config_plugin:</span>
<span class="sd">           key1: 5</span>
<span class="sd">           key2: &#39;5&#39;</span>

<span class="sd">    .. note::</span>

<span class="sd">       This initializer is only useful for the :py:class:`ConfigDict`</span>
<span class="sd">       ``implicit_domain`` argument (and not for &quot;regular&quot; ``domain``</span>
<span class="sd">       arguments)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    callback: Callable[[str, object], ConfigBase]</span>
<span class="sd">        A callable (function) that is passed the ConfigDict key and</span>
<span class="sd">        value, and is expected to return the appropriate Config object</span>
<span class="sd">        (ConfigValue, ConfigList, or ConfigDict)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">callback</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>


<span class="c1"># Note: Enum uses a metaclass to work its magic.  To get a deprecation</span>
<span class="c1"># warning when creating a subclass of ConfigEnum, we need to decorate</span>
<span class="c1"># the __new__ method here (doing the normal trick of letting the class</span>
<span class="c1"># decorator automatically wrap the class __new__ or __init__ methods</span>
<span class="c1"># does not behave the way one would think because those methods are</span>
<span class="c1"># actually created by the metaclass).  The &quot;empty&quot; class &quot;@deprecated()&quot;</span>
<span class="c1"># here will look into the resulting class and extract the docstring from</span>
<span class="c1"># the original __new__ to generate the class docstring.</span>
<span class="nd">@deprecated</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ConfigEnum</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;The ConfigEnum base class is deprecated.  &quot;</span>
        <span class="s2">&quot;Directly inherit from enum.Enum and then use &quot;</span>
        <span class="s2">&quot;In() or InEnum() as the ConfigValue &#39;domain&#39; for &quot;</span>
        <span class="s2">&quot;validation and int/string type conversions.&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.0&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">member</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">member</span><span class="o">.</span><span class="n">_value_</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">member</span><span class="o">.</span><span class="n">_args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="k">return</span> <span class="n">member</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_enum_or_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Handles enum or integer inputs</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>


<span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">=================================</span>
<span class="s2">The Pyomo Configuration System</span>
<span class="s2">=================================</span>

<span class="s2">The Pyomo config system provides a set of three classes</span>
<span class="s2">(:py:class:`ConfigDict`, :py:class:`ConfigList`, and</span>
<span class="s2">:py:class:`ConfigValue`) for managing and documenting structured</span>
<span class="s2">configuration information and user input.  The system is based around</span>
<span class="s2">the ConfigValue class, which provides storage for a single configuration</span>
<span class="s2">entry.  ConfigValue objects can be grouped using two containers</span>
<span class="s2">(ConfigDict and ConfigList), which provide functionality analogous to</span>
<span class="s2">Python&#39;s dict and list classes, respectively.</span>

<span class="s2">At its simplest, the Config system allows for developers to specify a</span>
<span class="s2">dictionary of documented configuration entries, allow users to provide</span>
<span class="s2">values for those entries, and retrieve the current values:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; from pyomo.common.config import (</span>
<span class="s2">    ...     ConfigDict, ConfigList, ConfigValue</span>
<span class="s2">    ... )</span>
<span class="s2">    &gt;&gt;&gt; config = ConfigDict()</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;filename&#39;, ConfigValue(</span>
<span class="s2">    ...     default=None,</span>
<span class="s2">    ...     domain=str,</span>
<span class="s2">    ...     description=&quot;Input file name&quot;,</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&quot;bound tolerance&quot;, ConfigValue(</span>
<span class="s2">    ...     default=1E-5,</span>
<span class="s2">    ...     domain=float,</span>
<span class="s2">    ...     description=&quot;Bound tolerance&quot;,</span>
<span class="s2">    ...     doc=&quot;Relative tolerance for bound feasibility checks&quot;</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&quot;iteration limit&quot;, ConfigValue(</span>
<span class="s2">    ...     default=30,</span>
<span class="s2">    ...     domain=int,</span>
<span class="s2">    ...     description=&quot;Iteration limit&quot;,</span>
<span class="s2">    ...     doc=&quot;Number of maximum iterations in the decomposition methods&quot;</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config[&#39;filename&#39;] = &#39;tmp.txt&#39;</span>
<span class="s2">    &gt;&gt;&gt; print(config[&#39;filename&#39;])</span>
<span class="s2">    tmp.txt</span>
<span class="s2">    &gt;&gt;&gt; print(config[&#39;iteration limit&#39;])</span>
<span class="s2">    30</span>

<span class="s2">For convenience, ConfigDict objects support read/write access via</span>
<span class="s2">attributes (with spaces in the declaration names replaced by</span>
<span class="s2">underscores):</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; print(config.filename)</span>
<span class="s2">    tmp.txt</span>
<span class="s2">    &gt;&gt;&gt; print(config.iteration_limit)</span>
<span class="s2">    30</span>
<span class="s2">    &gt;&gt;&gt; config.iteration_limit = 20</span>
<span class="s2">    &gt;&gt;&gt; print(config.iteration_limit)</span>
<span class="s2">    20</span>

<span class="s2">Domain validation</span>
<span class="s2">=================</span>

<span class="s2">All Config objects support a ``domain`` keyword that accepts a callable</span>
<span class="s2">object (type, function, or callable instance).  The domain callable</span>
<span class="s2">should take data and map it onto the desired domain, optionally</span>
<span class="s2">performing domain validation (see :py:class:`ConfigValue`,</span>
<span class="s2">:py:class:`ConfigDict`, and :py:class:`ConfigList` for more</span>
<span class="s2">information).  This allows client code to accept a very flexible set of</span>
<span class="s2">inputs without &quot;cluttering&quot; the code with input validation:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; config.iteration_limit = 35.5</span>
<span class="s2">    &gt;&gt;&gt; print(config.iteration_limit)</span>
<span class="s2">    35</span>
<span class="s2">    &gt;&gt;&gt; print(type(config.iteration_limit).__name__)</span>
<span class="s2">    int</span>

<span class="s2">In addition to common types (like ``int``, ``float``, ``bool``, and</span>
<span class="s2">``str``), the config system profides a number of custom domain</span>
<span class="s2">validators for common use cases:</span>

<span class="s2">.. autosummary::</span>

<span class="s2">   Bool</span>
<span class="s2">   Integer</span>
<span class="s2">   PositiveInt</span>
<span class="s2">   NegativeInt</span>
<span class="s2">   NonNegativeInt</span>
<span class="s2">   NonPositiveInt</span>
<span class="s2">   PositiveFloat</span>
<span class="s2">   NegativeFloat</span>
<span class="s2">   NonPositiveFloat</span>
<span class="s2">   NonNegativeFloat</span>
<span class="s2">   In</span>
<span class="s2">   InEnum</span>
<span class="s2">   ListOf</span>
<span class="s2">   Module</span>
<span class="s2">   Path</span>
<span class="s2">   PathList</span>
<span class="s2">   DynamicImplicitDomain</span>

<span class="s2">Configuring class hierarchies</span>
<span class="s2">=============================</span>

<span class="s2">A feature of the Config system is that the core classes all implement</span>
<span class="s2">``__call__``, and can themselves be used as ``domain`` values.  Beyond</span>
<span class="s2">providing domain verification for complex hierarchical structures, this</span>
<span class="s2">feature allows ConfigDicts to cleanly support the configuration of</span>
<span class="s2">derived objects.  Consider the following example:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; class Base(object):</span>
<span class="s2">    ...     CONFIG = ConfigDict()</span>
<span class="s2">    ...     CONFIG.declare(&#39;filename&#39;, ConfigValue(</span>
<span class="s2">    ...         default=&#39;input.txt&#39;,</span>
<span class="s2">    ...         domain=str,</span>
<span class="s2">    ...     ))</span>
<span class="s2">    ...     def __init__(self, **kwds):</span>
<span class="s2">    ...         c = self.CONFIG(kwds)</span>
<span class="s2">    ...         c.display()</span>
<span class="s2">    ...</span>
<span class="s2">    &gt;&gt;&gt; class Derived(Base):</span>
<span class="s2">    ...     CONFIG = Base.CONFIG()</span>
<span class="s2">    ...     CONFIG.declare(&#39;pattern&#39;, ConfigValue(</span>
<span class="s2">    ...         default=None,</span>
<span class="s2">    ...         domain=str,</span>
<span class="s2">    ...     ))</span>
<span class="s2">    ...</span>
<span class="s2">    &gt;&gt;&gt; tmp = Base(filename=&#39;foo.txt&#39;)</span>
<span class="s2">    filename: foo.txt</span>
<span class="s2">    &gt;&gt;&gt; tmp = Derived(pattern=&#39;.*warning&#39;)</span>
<span class="s2">    filename: input.txt</span>
<span class="s2">    pattern: .*warning</span>

<span class="s2">Here, the base class ``Base`` declares a class-level attribute CONFIG as a</span>
<span class="s2">ConfigDict containing a single entry (``filename``).  The derived class</span>
<span class="s2">(``Derived``) then starts by making a copy of the base class&#39; ``CONFIG``,</span>
<span class="s2">and then defines an additional entry (`pattern`).  Instances of the base</span>
<span class="s2">class will still create ``c`` instances that only have the single</span>
<span class="s2">``filename`` entry, whereas instances of the derived class will have ``c``</span>
<span class="s2">instances with two entries: the ``pattern`` entry declared by the derived</span>
<span class="s2">class, and the ``filename`` entry &quot;inherited&quot; from the base class.</span>

<span class="s2">An extension of this design pattern provides a clean approach for</span>
<span class="s2">handling &quot;ephemeral&quot; instance options.  Consider an interface to an</span>
<span class="s2">external &quot;solver&quot;.  Our class implements a ``solve()`` method that takes a</span>
<span class="s2">problem and sends it to the solver along with some solver configuration</span>
<span class="s2">options.  We would like to be able to set those options &quot;persistently&quot;</span>
<span class="s2">on instances of the interface class, but still override them</span>
<span class="s2">&quot;temporarily&quot; for individual calls to ``solve()``.  We implement this by</span>
<span class="s2">creating copies of the class&#39;s configuration for both specific instances</span>
<span class="s2">and for use by each ``solve()`` call:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; class Solver(object):</span>
<span class="s2">    ...     CONFIG = ConfigDict()</span>
<span class="s2">    ...     CONFIG.declare(&#39;iterlim&#39;, ConfigValue(</span>
<span class="s2">    ...         default=10,</span>
<span class="s2">    ...         domain=int,</span>
<span class="s2">    ...     ))</span>
<span class="s2">    ...     def __init__(self, **kwds):</span>
<span class="s2">    ...         self.config = self.CONFIG(kwds)</span>
<span class="s2">    ...     def solve(self, model, **options):</span>
<span class="s2">    ...         config = self.config(options)</span>
<span class="s2">    ...         # Solve the model with the specified iterlim</span>
<span class="s2">    ...         config.display()</span>
<span class="s2">    ...</span>
<span class="s2">    &gt;&gt;&gt; solver = Solver()</span>
<span class="s2">    &gt;&gt;&gt; solver.solve(None)</span>
<span class="s2">    iterlim: 10</span>
<span class="s2">    &gt;&gt;&gt; solver.config.iterlim = 20</span>
<span class="s2">    &gt;&gt;&gt; solver.solve(None)</span>
<span class="s2">    iterlim: 20</span>
<span class="s2">    &gt;&gt;&gt; solver.solve(None, iterlim=50)</span>
<span class="s2">    iterlim: 50</span>
<span class="s2">    &gt;&gt;&gt; solver.solve(None)</span>
<span class="s2">    iterlim: 20</span>


<span class="s2">Interacting with argparse</span>
<span class="s2">=========================</span>

<span class="s2">In addition to basic storage and retrieval, the Config system provides</span>
<span class="s2">hooks to the argparse command-line argument parsing system.  Individual</span>
<span class="s2">Config entries can be declared as argparse arguments using the</span>
<span class="s2">:py:meth:`~ConfigBase.declare_as_argument` method.  To make declaration</span>
<span class="s2">simpler, the :py:meth:`declare` method returns the declared Config</span>
<span class="s2">object so that the argument declaration can be done inline:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; import argparse</span>
<span class="s2">    &gt;&gt;&gt; config = ConfigDict()</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;iterlim&#39;, ConfigValue(</span>
<span class="s2">    ...     domain=int,</span>
<span class="s2">    ...     default=100,</span>
<span class="s2">    ...     description=&quot;iteration limit&quot;,</span>
<span class="s2">    ... )).declare_as_argument()</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;lbfgs&#39;, ConfigValue(</span>
<span class="s2">    ...     domain=bool,</span>
<span class="s2">    ...     description=&quot;use limited memory BFGS update&quot;,</span>
<span class="s2">    ... )).declare_as_argument()</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;linesearch&#39;, ConfigValue(</span>
<span class="s2">    ...     domain=bool,</span>
<span class="s2">    ...     default=True,</span>
<span class="s2">    ...     description=&quot;use line search&quot;,</span>
<span class="s2">    ... )).declare_as_argument()</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;relative tolerance&#39;, ConfigValue(</span>
<span class="s2">    ...     domain=float,</span>
<span class="s2">    ...     description=&quot;relative convergence tolerance&quot;,</span>
<span class="s2">    ... )).declare_as_argument(&#39;--reltol&#39;, &#39;-r&#39;, group=&#39;Tolerances&#39;)</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;absolute tolerance&#39;, ConfigValue(</span>
<span class="s2">    ...     domain=float,</span>
<span class="s2">    ...     description=&quot;absolute convergence tolerance&quot;,</span>
<span class="s2">    ... )).declare_as_argument(&#39;--abstol&#39;, &#39;-a&#39;, group=&#39;Tolerances&#39;)</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>

<span class="s2">The ConfigDict can then be used to initialize (or augment) an argparse</span>
<span class="s2">ArgumentParser object:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; parser = argparse.ArgumentParser(&quot;tester&quot;)</span>
<span class="s2">    &gt;&gt;&gt; config.initialize_argparse(parser)</span>


<span class="s2">Key information from the ConfigDict is automatically transferred over</span>
<span class="s2">to the ArgumentParser object:</span>

<span class="s2">.. doctest::</span>
<span class="s2">   :hide:</span>

<span class="s2">    &gt;&gt;&gt; import os</span>
<span class="s2">    &gt;&gt;&gt; original_environ, os.environ = os.environ, os.environ.copy()</span>
<span class="s2">    &gt;&gt;&gt; os.environ[&#39;COLUMNS&#39;] = &#39;80&#39;</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; print(parser.format_help())</span>
<span class="s2">    usage: tester [-h] [--iterlim INT] [--lbfgs] [--disable-linesearch]</span>
<span class="s2">                  [--reltol FLOAT] [--abstol FLOAT]</span>
<span class="s2">    ...</span>
<span class="s2">      -h, --help            show this help message and exit</span>
<span class="s2">      --iterlim INT         iteration limit</span>
<span class="s2">      --lbfgs               use limited memory BFGS update</span>
<span class="s2">      --disable-linesearch  [DON&#39;T] use line search</span>
<span class="s2">    &lt;BLANKLINE&gt;</span>
<span class="s2">    Tolerances:</span>
<span class="s2">      --reltol FLOAT, -r FLOAT</span>
<span class="s2">                            relative convergence tolerance</span>
<span class="s2">      --abstol FLOAT, -a FLOAT</span>
<span class="s2">                            absolute convergence tolerance</span>
<span class="s2">    &lt;BLANKLINE&gt;</span>

<span class="s2">.. doctest::</span>
<span class="s2">   :hide:</span>

<span class="s2">    &gt;&gt;&gt; os.environ = original_environ</span>

<span class="s2">Parsed arguments can then be imported back into the ConfigDict:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; args=parser.parse_args([&#39;--lbfgs&#39;, &#39;--reltol&#39;, &#39;0.1&#39;, &#39;-a&#39;, &#39;0.2&#39;])</span>
<span class="s2">    &gt;&gt;&gt; args = config.import_argparse(args)</span>
<span class="s2">    &gt;&gt;&gt; config.display()</span>
<span class="s2">    iterlim: 100</span>
<span class="s2">    lbfgs: true</span>
<span class="s2">    linesearch: true</span>
<span class="s2">    relative tolerance: 0.1</span>
<span class="s2">    absolute tolerance: 0.2</span>

<span class="s2">Accessing user-specified values</span>
<span class="s2">===============================</span>

<span class="s2">It is frequently useful to know which values a user explicitly set, and</span>
<span class="s2">which values a user explicitly set but have never been retrieved.  The</span>
<span class="s2">configuration system provides two generator methods to return the items</span>
<span class="s2">that a user explicitly set (:py:meth:`user_values`) and the items that</span>
<span class="s2">were set but never retrieved (:py:meth:`unused_user_values`):</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; print([val.name() for val in config.user_values()])</span>
<span class="s2">    [&#39;lbfgs&#39;, &#39;relative tolerance&#39;, &#39;absolute tolerance&#39;]</span>
<span class="s2">    &gt;&gt;&gt; print(config.relative_tolerance)</span>
<span class="s2">    0.1</span>
<span class="s2">    &gt;&gt;&gt; print([val.name() for val in config.unused_user_values()])</span>
<span class="s2">    [&#39;lbfgs&#39;, &#39;absolute tolerance&#39;]</span>

<span class="s2">Generating output &amp; documentation</span>
<span class="s2">=================================</span>

<span class="s2">Configuration objects support three methods for generating output and</span>
<span class="s2">documentation: :py:meth:`display()`,</span>
<span class="s2">:py:meth:`generate_yaml_template()`, and</span>
<span class="s2">:py:meth:`generate_documentation()`.  The simplest is</span>
<span class="s2">:py:meth:`display()`, which prints out the current values of the</span>
<span class="s2">configuration object (and if it is a container type, all of it&#39;s</span>
<span class="s2">children).  :py:meth:`generate_yaml_template` is simular to</span>
<span class="s2">:py:meth:`display`, but also includes the description fields as</span>
<span class="s2">formatted comments.</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; solver_config = config</span>
<span class="s2">    &gt;&gt;&gt; config = ConfigDict()</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;output&#39;, ConfigValue(</span>
<span class="s2">    ...     default=&#39;results.yml&#39;,</span>
<span class="s2">    ...     domain=str,</span>
<span class="s2">    ...     description=&#39;output results filename&#39;</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;verbose&#39;, ConfigValue(</span>
<span class="s2">    ...     default=0,</span>
<span class="s2">    ...     domain=int,</span>
<span class="s2">    ...     description=&#39;output verbosity&#39;,</span>
<span class="s2">    ...     doc=&#39;This sets the system verbosity.  The default (0) only logs &#39;</span>
<span class="s2">    ...     &#39;warnings and errors.  Larger integer values will produce &#39;</span>
<span class="s2">    ...     &#39;additional log messages.&#39;,</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigValue object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.declare(&#39;solvers&#39;, ConfigList(</span>
<span class="s2">    ...     domain=solver_config,</span>
<span class="s2">    ...     description=&#39;list of solvers to apply&#39;,</span>
<span class="s2">    ... ))</span>
<span class="s2">    &lt;pyomo.common.config.ConfigList object at ...&gt;</span>
<span class="s2">    &gt;&gt;&gt; config.display()</span>
<span class="s2">    output: results.yml</span>
<span class="s2">    verbose: 0</span>
<span class="s2">    solvers: []</span>
<span class="s2">    &gt;&gt;&gt; print(config.generate_yaml_template())</span>
<span class="s2">    output: results.yml  # output results filename</span>
<span class="s2">    verbose: 0           # output verbosity</span>
<span class="s2">    solvers: []          # list of solvers to apply</span>
<span class="s2">    &lt;BLANKLINE&gt;</span>

<span class="s2">It is important to note that both methods document the current state of</span>
<span class="s2">the configuration object.  So, in the example above, since the `solvers`</span>
<span class="s2">list is empty, you will not get any information on the elements in the</span>
<span class="s2">list.  Of course, if you add a value to the list, then the data will be</span>
<span class="s2">output:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; tmp = config()</span>
<span class="s2">    &gt;&gt;&gt; tmp.solvers.append(</span><span class="si">{}</span><span class="s2">)</span>
<span class="s2">    &gt;&gt;&gt; tmp.display()</span>
<span class="s2">    output: results.yml</span>
<span class="s2">    verbose: 0</span>
<span class="s2">    solvers:</span>
<span class="s2">      -</span>
<span class="s2">        iterlim: 100</span>
<span class="s2">        lbfgs: true</span>
<span class="s2">        linesearch: true</span>
<span class="s2">        relative tolerance: 0.1</span>
<span class="s2">        absolute tolerance: 0.2</span>
<span class="s2">    &gt;&gt;&gt; print(tmp.generate_yaml_template())</span>
<span class="s2">    output: results.yml          # output results filename</span>
<span class="s2">    verbose: 0                   # output verbosity</span>
<span class="s2">    solvers:                     # list of solvers to apply</span>
<span class="s2">      -</span>
<span class="s2">        iterlim: 100             # iteration limit</span>
<span class="s2">        lbfgs: true              # use limited memory BFGS update</span>
<span class="s2">        linesearch: true         # use line search</span>
<span class="s2">        relative tolerance: 0.1  # relative convergence tolerance</span>
<span class="s2">        absolute tolerance: 0.2  # absolute convergence tolerance</span>
<span class="s2">    &lt;BLANKLINE&gt;</span>

<span class="s2">The third method (:py:meth:`generate_documentation`) behaves</span>
<span class="s2">differently.  This method is designed to generate reference</span>
<span class="s2">documentation.  For each configuration item, the `doc` field is output.</span>
<span class="s2">If the item has no `doc`, then the `description` field is used.</span>

<span class="s2">List containers have their *domain* documented and not their current</span>
<span class="s2">values.  The documentation can be configured through optional arguments.</span>
<span class="s2">The defaults generate LaTeX documentation:</span>

<span class="s2">.. doctest::</span>

<span class="s2">    &gt;&gt;&gt; print(config.generate_documentation())</span>
<span class="s2">    </span><span class="se">\\</span><span class="s2">begin</span><span class="si">{description}</span><span class="s2">[topsep=0pt,parsep=0.5em,itemsep=-0.4em]</span>
<span class="s2">      </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{output}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">        </span><span class="se">\\\\</span><span class="s2">output results filename</span>
<span class="s2">      </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{verbose}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">        </span><span class="se">\\\\</span><span class="s2">This sets the system verbosity.  The default (0) only logs warnings and</span>
<span class="s2">        errors.  Larger integer values will produce additional log messages.</span>
<span class="s2">      </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{solvers}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">        </span><span class="se">\\\\</span><span class="s2">list of solvers to apply</span>
<span class="s2">      </span><span class="se">\\</span><span class="s2">begin</span><span class="si">{description}</span><span class="s2">[topsep=0pt,parsep=0.5em,itemsep=-0.4em]</span>
<span class="s2">        </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{iterlim}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">          </span><span class="se">\\\\</span><span class="s2">iteration limit</span>
<span class="s2">        </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{lbfgs}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">          </span><span class="se">\\\\</span><span class="s2">use limited memory BFGS update</span>
<span class="s2">        </span><span class="se">\\</span><span class="s2">item[</span><span class="si">{linesearch}</span><span class="s2">]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">          </span><span class="se">\\\\</span><span class="s2">use line search</span>
<span class="s2">        </span><span class="se">\\</span><span class="s2">item[{relative tolerance}]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">          </span><span class="se">\\\\</span><span class="s2">relative convergence tolerance</span>
<span class="s2">        </span><span class="se">\\</span><span class="s2">item[{absolute tolerance}]</span><span class="se">\\</span><span class="s2">hfill</span>
<span class="s2">          </span><span class="se">\\\\</span><span class="s2">absolute convergence tolerance</span>
<span class="s2">      </span><span class="se">\\</span><span class="s2">end</span><span class="si">{description}</span><span class="s2"></span>
<span class="s2">    </span><span class="se">\\</span><span class="s2">end</span><span class="si">{description}</span><span class="s2"></span>
<span class="s2">    &lt;BLANKLINE&gt;</span>

<span class="s2">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">_dump</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">yaml</span> <span class="kn">import</span> <span class="n">dump</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="c1"># dump = lambda x,**y: str(x)</span>
        <span class="c1"># YAML uses lowercase True/False</span>
        <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">assert</span> <span class="s1">&#39;_dump&#39;</span> <span class="ow">in</span> <span class="nb">globals</span><span class="p">()</span>
    <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;_dump&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dump</span>
    <span class="k">return</span> <span class="n">dump</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_munge_name</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">space_to_dash</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">space_to_dash</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z0-9-_]&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_domain_name</span><span class="p">(</span><span class="n">domain</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">domain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="s1">&#39;domain_name&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="n">domain_name</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">domain</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">domain</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">domain</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="n">_leadingSpace</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;^([ </span><span class="se">\t</span><span class="s1">]*)&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_strip_indentation</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">doc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">lines</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span>
    <span class="n">minIndent</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_leadingSpace</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_leadingSpace</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">minIndent</span><span class="p">:</span>
        <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">minIndent</span><span class="p">:]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">lines</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">minIndent</span><span class="p">:]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_value2string</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="n">prefix</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_data</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">obj</span> <span class="k">else</span> <span class="n">value</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">builtins</span><span class="p">,</span> <span class="n">_data</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_str</span> <span class="o">+=</span> <span class="n">_dump</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">):</span>
                    <span class="n">_str</span> <span class="o">=</span> <span class="n">_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">_data</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_value2yaml</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">_str</span> <span class="o">=</span> <span class="n">prefix</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">_data</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">obj</span> <span class="k">else</span> <span class="n">value</span>
            <span class="n">_str</span> <span class="o">+=</span> <span class="n">_dump</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">):</span>
                <span class="n">_str</span> <span class="o">=</span> <span class="n">_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">_str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_UnpickleableDomain</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;%s &#39;%s&#39; was pickled with an unpicklable domain.</span>
<span class="sd">    The domain was stripped and lost during the pickle process.  Setting</span>
<span class="sd">    new values on the restored object cannot be mapped into the correct</span>
<span class="sd">    domain.</span>
<span class="sd">&quot;&quot;&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">arg</span>


<span class="k">def</span> <span class="nf">_picklable</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="n">ftype</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="c1"># If the field is a type (class, etc), cache the &#39;known&#39; status of</span>
    <span class="c1"># the actual field type and not the generic &#39;type&#39; class</span>
    <span class="k">if</span> <span class="n">ftype</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">:</span>
        <span class="n">ftype</span> <span class="o">=</span> <span class="n">field</span>
    <span class="k">if</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="n">_picklable</span><span class="o">.</span><span class="n">known</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">field</span> <span class="k">if</span> <span class="n">_picklable</span><span class="o">.</span><span class="n">known</span><span class="p">[</span><span class="n">ftype</span><span class="p">]</span> <span class="k">else</span> <span class="n">_UnpickleableDomain</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ftype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_picklable</span><span class="o">.</span><span class="n">unknowable_types</span><span class="p">:</span>
            <span class="n">_picklable</span><span class="o">.</span><span class="n">known</span><span class="p">[</span><span class="n">ftype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">field</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># Contrary to the documentation, Python is not at all consistent</span>
        <span class="c1"># with the exception that is raised when pickling an object</span>
        <span class="c1"># fails:</span>
        <span class="c1">#</span>
        <span class="c1">#    Python 2.6 - 3.4:  pickle.PicklingError</span>
        <span class="c1">#    Python 3.5 - 3.6:  AttributeError</span>
        <span class="c1">#    Python 2.6 - 2.7 (cPickle):  TypeError</span>
        <span class="c1">#</span>
        <span class="c1"># What we are concerned about is masking things like recursion</span>
        <span class="c1"># errors.  Unfortunately, Python is not quite consistent there,</span>
        <span class="c1"># either: exceeding recursion depth raises a RuntimeError</span>
        <span class="c1"># through 3.4, then switches to a RecursionError (a derivative</span>
        <span class="c1"># of RuntimeError).</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="ne">RuntimeError</span><span class="p">):</span>
            <span class="k">raise</span>
        <span class="k">if</span> <span class="n">ftype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_picklable</span><span class="o">.</span><span class="n">unknowable_types</span><span class="p">:</span>
            <span class="n">_picklable</span><span class="o">.</span><span class="n">known</span><span class="p">[</span><span class="n">ftype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">_UnpickleableDomain</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>


<span class="n">_picklable</span><span class="o">.</span><span class="n">known</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># The &quot;picklability&quot; of some types is not categorically &quot;knowable&quot;</span>
<span class="c1"># (e.g., functions can be pickled, but only if they are declared at the</span>
<span class="c1"># module scope)</span>
<span class="n">_picklable</span><span class="o">.</span><span class="n">unknowable_types</span> <span class="o">=</span> <span class="p">{</span><span class="nb">type</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">FunctionType</span><span class="p">}</span>

<span class="n">_store_bool</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="s1">&#39;store_false&#39;</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">_build_lexer</span><span class="p">(</span><span class="n">literals</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="c1"># Ignore whitespace (space, tab, linefeed, and comma)</span>
    <span class="n">t_ignore</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="se">\t\r</span><span class="s2">,&quot;</span>

    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;STRING&quot;</span><span class="p">,</span> <span class="s2">&quot;WORD&quot;</span><span class="p">]</span>  <span class="c1"># quoted string  # unquoted string</span>

    <span class="c1"># A &quot;string&quot; is a proper quoted string</span>
    <span class="n">_quoted_str</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&#39;(?:[^&#39;</span><span class="se">\\</span><span class="s2">]|</span><span class="se">\\</span><span class="s2">.)*&#39;&quot;</span>
    <span class="n">_general_str</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_quoted_str</span><span class="p">,</span> <span class="n">_quoted_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)])</span>

    <span class="nd">@ply</span><span class="o">.</span><span class="n">lex</span><span class="o">.</span><span class="n">TOKEN</span><span class="p">(</span><span class="n">_general_str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">t_STRING</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="c1"># A &quot;word&quot; contains no whitesspace or commas</span>
    <span class="nd">@ply</span><span class="o">.</span><span class="n">lex</span><span class="o">.</span><span class="n">TOKEN</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">t_ignore</span> <span class="o">+</span> <span class="n">literals</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;]+&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">t_WORD</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">t</span>

    <span class="c1"># Error handling rule</span>
    <span class="k">def</span> <span class="nf">t_error</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="c1"># Note this parser does not allow &quot;\n&quot;, so lexpos is the</span>
        <span class="c1"># column number</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
            <span class="s2">&quot;ERROR: Token &#39;</span><span class="si">%s</span><span class="s2">&#39; Line </span><span class="si">%s</span><span class="s2"> Column </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">lexpos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">ply</span><span class="o">.</span><span class="n">lex</span><span class="o">.</span><span class="n">lex</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_default_string_list_lexer</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple string tokenizer for lists of words.</span>

<span class="sd">    This default lexer splits strings on whitespace and/or commas while</span>
<span class="sd">    honoring use of single and double quotes.  Separators (whitespace or</span>
<span class="sd">    commas) are not returned.  Consecutive delimiters are ignored (and</span>
<span class="sd">    do not yield empty strings).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_lex</span> <span class="o">=</span> <span class="n">_default_string_list_lexer</span><span class="o">.</span><span class="n">_lex</span>
    <span class="k">if</span> <span class="n">_lex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_default_string_list_lexer</span><span class="o">.</span><span class="n">_lex</span> <span class="o">=</span> <span class="n">_lex</span> <span class="o">=</span> <span class="n">_build_lexer</span><span class="p">()</span>
    <span class="n">_lex</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">tok</span> <span class="o">=</span> <span class="n">_lex</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tok</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">yield</span> <span class="n">tok</span><span class="o">.</span><span class="n">value</span>


<span class="n">_default_string_list_lexer</span><span class="o">.</span><span class="n">_lex</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">_default_string_dict_lexer</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple string tokenizer for dict data.</span>

<span class="sd">    This default lexer splits strings on whitespace and/or commas while</span>
<span class="sd">    honoring use of single and double quotes.  &#39;:&#39; and &#39;=&#39; are</span>
<span class="sd">    recognized as special tokens.  Separators (whitespace or commas) are</span>
<span class="sd">    not returned.  Consecutive delimiters are ignored (and do not yield</span>
<span class="sd">    empty strings).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_lex</span> <span class="o">=</span> <span class="n">_default_string_dict_lexer</span><span class="o">.</span><span class="n">_lex</span>
    <span class="k">if</span> <span class="n">_lex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">_default_string_dict_lexer</span><span class="o">.</span><span class="n">_lex</span> <span class="o">=</span> <span class="n">_lex</span> <span class="o">=</span> <span class="n">_build_lexer</span><span class="p">(</span><span class="s1">&#39;:=&#39;</span><span class="p">)</span>
    <span class="n">_lex</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">_lex</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="n">_lex</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sep</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Expected &#39;:&#39; or &#39;=&#39; but encountered end of string&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sep</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;:=&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected &#39;:&#39; or &#39;=&#39; but found &#39;</span><span class="si">{</span><span class="n">sep</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; at &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">sep</span><span class="o">.</span><span class="n">lineno</span><span class="si">}</span><span class="s2"> Column </span><span class="si">{</span><span class="n">sep</span><span class="o">.</span><span class="n">lexpos</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">_lex</span><span class="o">.</span><span class="n">token</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected value following &#39;</span><span class="si">{</span><span class="n">sep</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but encountered end of string&quot;</span>
            <span class="p">)</span>
        <span class="k">yield</span> <span class="n">key</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">val</span><span class="o">.</span><span class="n">value</span>


<span class="n">_default_string_dict_lexer</span><span class="o">.</span><span class="n">_lex</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">_formatter_str_to_callback</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
    <span class="s2">&quot;Wrapper function that converts formatter strings to callback functions&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="n">pattern</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="n">pattern</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_formatter_str_to_item_callback</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
    <span class="s2">&quot;Wrapper function that converts item formatter strings to callback functions&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">pattern</span><span class="p">:</span>
        <span class="n">_item_body_formatter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">pattern</span> <span class="o">%</span> <span class="p">(</span><span class="n">doc</span><span class="p">,)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_item_body_formatter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">pattern</span>

    <span class="k">def</span> <span class="nf">_item_body_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">_doc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">_doc</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">_description</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_doc</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">wraplines</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_doc</span>
        <span class="n">_doc</span> <span class="o">=</span> <span class="n">_item_body_formatter</span><span class="p">(</span><span class="n">_doc</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_doc</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="n">_indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span>
        <span class="k">if</span> <span class="n">wraplines</span><span class="p">:</span>
            <span class="n">doc_lines</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span>
                <span class="n">_doc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">initial_indent</span><span class="o">=</span><span class="n">_indent</span><span class="p">,</span> <span class="n">subsequent_indent</span><span class="o">=</span><span class="n">_indent</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc_lines</span><span class="p">))</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_doc</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">_item_body_cb</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ConfigFormatter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent_spacing</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">visibility</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span> <span class="o">=</span> <span class="n">indent_spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="n">visibility</span>

    <span class="k">def</span> <span class="nf">_block_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_block_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_item_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_item_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_item_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">indent_spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize</span><span class="p">(</span><span class="n">indent_spacing</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">visibility</span><span class="p">)</span>
        <span class="n">level</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lastObj</span> <span class="o">=</span> <span class="n">config</span>
        <span class="n">indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lvl</span><span class="p">:</span>
                <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">lvl</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lastObj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_block_start</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">lastObj</span><span class="p">)</span>
                <span class="n">indent</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">indent_spacing</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">lvl</span><span class="p">:</span>
                <span class="n">_last</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">_last</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span><span class="p">[:</span><span class="o">-</span><span class="n">indent_spacing</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_block_end</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">_last</span><span class="p">)</span>

            <span class="n">lastObj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_item_start</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_item_body</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_item_end</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">level</span><span class="p">:</span>
            <span class="n">_last</span> <span class="o">=</span> <span class="n">level</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_last</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span><span class="p">[:</span><span class="o">-</span><span class="n">indent_spacing</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_block_end</span><span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">_last</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_finalize</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">String_ConfigFormatter</span><span class="p">(</span><span class="n">ConfigFormatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block_start</span><span class="p">,</span> <span class="n">block_end</span><span class="p">,</span> <span class="n">item_start</span><span class="p">,</span> <span class="n">item_body</span><span class="p">,</span> <span class="n">item_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_block_start</span> <span class="o">=</span> <span class="n">_formatter_str_to_callback</span><span class="p">(</span><span class="n">block_start</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_block_end</span> <span class="o">=</span> <span class="n">_formatter_str_to_callback</span><span class="p">(</span><span class="n">block_end</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_start</span> <span class="o">=</span> <span class="n">_formatter_str_to_callback</span><span class="p">(</span><span class="n">item_start</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_end</span> <span class="o">=</span> <span class="n">_formatter_str_to_callback</span><span class="p">(</span><span class="n">item_end</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_item_body</span> <span class="o">=</span> <span class="n">_formatter_str_to_item_callback</span><span class="p">(</span><span class="n">item_body</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">LaTeX_ConfigFormatter</span><span class="p">(</span><span class="n">String_ConfigFormatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">begin</span><span class="si">{description}</span><span class="s2">[topsep=0pt,parsep=0.5em,itemsep=-0.4em]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">end</span><span class="si">{description}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">item[{</span><span class="si">%s</span><span class="s2">}]</span><span class="se">\\</span><span class="s2">hfill</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="se">\\\\</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">numpydoc_ConfigFormatter</span><span class="p">(</span><span class="n">ConfigFormatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_initialize</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">TextWrapper</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_item_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">typeinfo</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">filter</span><span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="s1">&#39;dict&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">)</span> <span class="k">else</span> <span class="n">obj</span><span class="o">.</span><span class="n">domain_name</span><span class="p">(),</span>
                    <span class="s1">&#39;optional&#39;</span>
                    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_default</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;default=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_default</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Note that numpydoc / ReST specifies that the colon in</span>
        <span class="c1"># definition lists be surrounded by spaces (i.e., &quot; : &quot;).</span>
        <span class="c1"># However, as of numpydoc (1.1.0) / Sphinx (3.4.3) / napoleon</span>
        <span class="c1"># (0.7), things aren&#39;t really geared for nested lists of</span>
        <span class="c1"># parameters.  Definition lists omit the colon, and</span>
        <span class="c1"># sub-definitions are rendered as normal definition sections</span>
        <span class="c1"># (without the special formatting applied to Parameters lists),</span>
        <span class="c1"># leading to less readable docs.  As they tolerate omitting the</span>
        <span class="c1"># space before the colon at the top level (which at lower levels</span>
        <span class="c1"># causes nested definition lists to NOT omit the colon), we will</span>
        <span class="c1"># generate non-standard ReST and omit the preceding space:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">indent</span><span class="si">}{</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">()</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">typeinfo</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">initial_indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">subsequent_indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span>
        <span class="n">vis</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">_visibility</span> <span class="o">&gt;=</span> <span class="n">ADVANCED_OPTION</span><span class="p">:</span>
            <span class="n">vis</span> <span class="o">=</span> <span class="s2">&quot;[ADVANCED option]&quot;</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_visibility</span> <span class="o">&gt;=</span> <span class="n">DEVELOPER_OPTION</span><span class="p">:</span>
                <span class="n">vis</span> <span class="o">=</span> <span class="s2">&quot;[DEVELOPER option]&quot;</span>
        <span class="n">itemdoc</span> <span class="o">=</span> <span class="n">wrap_reStructuredText</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="nb">filter</span><span class="p">(</span>
                    <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="n">vis</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_doc</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">_description</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)]</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapper</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">itemdoc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">itemdoc</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>


<span class="n">ConfigFormatter</span><span class="o">.</span><span class="n">formats</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;latex&#39;</span><span class="p">:</span> <span class="n">LaTeX_ConfigFormatter</span><span class="p">,</span>
    <span class="s1">&#39;numpydoc&#39;</span><span class="p">:</span> <span class="n">numpydoc_ConfigFormatter</span><span class="p">,</span>
<span class="p">}</span>


<span class="nd">@deprecated</span><span class="p">(</span>
    <span class="s2">&quot;add_docstring_list is deprecated.  Please use the &quot;</span>
    <span class="s2">&quot;@document_kwargs_from_configdict() decorator.&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">add_docstring_list</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">configdict</span><span class="p">,</span> <span class="n">indent_by</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the docstring with a formatted configuration arguments listing.&quot;&quot;&quot;</span>
    <span class="n">section</span> <span class="o">=</span> <span class="s1">&#39;Keyword Arguments&#39;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
        <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="o">+</span> <span class="n">section</span>
        <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
        <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="o">+</span> <span class="n">configdict</span><span class="o">.</span><span class="n">generate_documentation</span><span class="p">(</span>
            <span class="n">indent_spacing</span><span class="o">=</span><span class="n">indent_by</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;numpydoc&#39;</span>
        <span class="p">)</span>
    <span class="p">)</span>


<div class="viewcode-block" id="document_kwargs_from_configdict"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.document_kwargs_from_configdict">[docs]</a><span class="k">class</span> <span class="nc">document_kwargs_from_configdict</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorator to append the documentation of a ConfigDict to the docstring</span>

<span class="sd">    This adds the documentation of the specified :py:class:`ConfigDict`</span>
<span class="sd">    (using the :py:class:`numpydoc_ConfigFormatter` formatter) to the</span>
<span class="sd">    decorated object&#39;s docstring.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config : ConfigDict or str</span>
<span class="sd">        the :py:class:`ConfigDict` to document.  If a ``str``, then the</span>
<span class="sd">        :py:class:`ConfigDict` is obtained by retrieving the named</span>
<span class="sd">        attribute from the decorated object (thereby enabling</span>
<span class="sd">        documenting class objects whose ``__init__`` keyword arguments</span>
<span class="sd">        are processed by a :py:class:`ConfigDict` class attribute)</span>

<span class="sd">    section : str</span>
<span class="sd">        the section header to preface config documentation with</span>

<span class="sd">    indent_spacing : int</span>
<span class="sd">        number of spaces to indent each block of documentation</span>

<span class="sd">    width : int</span>
<span class="sd">        total documentation width in characters (for wrapping paragraphs)</span>

<span class="sd">    doc : str, optional</span>
<span class="sd">        the initial docstring to append the ConfigDict documentation to.</span>
<span class="sd">        If None, then the decorated object&#39;s ``__doc__`` will be used.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; from pyomo.common.config import (</span>
<span class="sd">    ...     ConfigDict, ConfigValue, document_kwargs_from_configdict</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; class MyClass(object):</span>
<span class="sd">    ...     CONFIG = ConfigDict()</span>
<span class="sd">    ...     CONFIG.declare(&#39;iterlim&#39;, ConfigValue(</span>
<span class="sd">    ...         default=3000,</span>
<span class="sd">    ...         domain=int,</span>
<span class="sd">    ...         doc=&quot;Iteration limit.  Specify None for no limit&quot;</span>
<span class="sd">    ...     ))</span>
<span class="sd">    ...     CONFIG.declare(&#39;tee&#39;, ConfigValue(</span>
<span class="sd">    ...         domain=bool,</span>
<span class="sd">    ...         doc=&quot;If True, stream the solver output to the console&quot;</span>
<span class="sd">    ...     ))</span>
<span class="sd">    ...</span>
<span class="sd">    ...     @document_kwargs_from_configdict(CONFIG)</span>
<span class="sd">    ...     def solve(self, **kwargs):</span>
<span class="sd">    ...         config = self.CONFIG(kwargs)</span>
<span class="sd">    ...         # ...</span>
<span class="sd">    ...</span>
<span class="sd">    &gt;&gt;&gt; help(MyClass.solve)</span>
<span class="sd">    Help on function solve:</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    solve(self, **kwargs)</span>
<span class="sd">        Keyword Arguments</span>
<span class="sd">        -----------------</span>
<span class="sd">        iterlim: int, default=3000</span>
<span class="sd">            Iteration limit.  Specify None for no limit</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">        tee: bool, optional</span>
<span class="sd">            If True, stream the solver output to the console</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">,</span>
        <span class="n">section</span><span class="o">=</span><span class="s1">&#39;Keyword Arguments&#39;</span><span class="p">,</span>
        <span class="n">indent_spacing</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span>
        <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">section</span><span class="p">:</span>
            <span class="n">section</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">section</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">section</span> <span class="o">=</span> <span class="n">section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span> <span class="o">=</span> <span class="n">indent_spacing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="n">visibility</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcn</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fcn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">fcn</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="n">fcn</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">doc</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">doc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">doc</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">doc</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">fcn</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">doc</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">section</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">generate_documentation</span><span class="p">(</span>
                <span class="n">indent_spacing</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">indent_spacing</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                <span class="n">visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">visibility</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;numpydoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fcn</span></div>


<div class="viewcode-block" id="ConfigBase"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase">[docs]</a><span class="k">class</span> <span class="nc">ConfigBase</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;_parent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_userSet&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_userAccessed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_data&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_default&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_domain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_description&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_doc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_visibility&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_argparse&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># This just needs to be any singleton-like object; we use it so that</span>
    <span class="c1"># we can tell if an argument is provided (and we can&#39;t use None as</span>
    <span class="c1"># None is a valid user-specified argument).  Making it a class helps</span>
    <span class="c1"># when Config objects are pickled.</span>
<div class="viewcode-block" id="ConfigBase.NoArgument"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.NoArgument">[docs]</a>    <span class="k">class</span> <span class="nc">NoArgument</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">pass</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">=</span> <span class="n">_strip_indentation</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doc</span> <span class="o">=</span> <span class="n">_strip_indentation</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span> <span class="o">=</span> <span class="n">visibility</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_argparse</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Nominally, __getstate__() should return:</span>
        <span class="c1">#</span>
        <span class="c1"># state = super(Class, self).__getstate__()</span>
        <span class="c1"># for i in Class.__slots__:</span>
        <span class="c1">#    state[i] = getattr(self,i)</span>
        <span class="c1"># return state</span>
        <span class="c1">#</span>
        <span class="c1"># However, in this case, the (nominal) parent class is</span>
        <span class="c1"># &#39;object&#39;, and object does not implement __getstate__.  Since</span>
        <span class="c1"># super() doesn&#39;t actually return a class, we are going to check</span>
        <span class="c1"># the *derived class*&#39;s MRO and see if this is the second to</span>
        <span class="c1"># last class (the last is always &#39;object&#39;).  If it is, then we</span>
        <span class="c1"># can allocate the state dictionary.  If it is not, then we call</span>
        <span class="c1"># the super-class&#39;s __getstate__ (since that class is NOT</span>
        <span class="c1"># &#39;object&#39;).</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ConfigBase</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">}</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_picklable</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;_domain&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_parent&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Note: per the Python data model docs, we explicitly</span>
            <span class="c1"># set the attribute using object.__setattr__() instead</span>
            <span class="c1"># of setting self.__dict__[key] = val.</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">visibility</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">implicit</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">implicit_domain</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">,</span>
        <span class="n">preserve_implicit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># We will pass through overriding arguments to the constructor.</span>
        <span class="c1"># This way if the constructor does special processing of any of</span>
        <span class="c1"># the arguments (like implicit_domain), we don&#39;t have to repeat</span>
        <span class="c1"># that code here.  Unfortunately, it means we need to do a bit</span>
        <span class="c1"># of logic to be sure we only pass through appropriate</span>
        <span class="c1"># arguments.</span>
        <span class="n">kwds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;doc&#39;</span><span class="p">,</span> <span class="s1">&#39;visibility&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">):</span>
            <span class="n">fields</span> <span class="o">+=</span> <span class="p">((</span><span class="s1">&#39;implicit&#39;</span><span class="p">,</span> <span class="s1">&#39;_implicit_declaration&#39;</span><span class="p">),</span> <span class="s1">&#39;implicit_domain&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">domain</span> <span class="ow">is</span> <span class="n">NOTSET</span>
            <span class="k">assert</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTSET</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;domain&#39;</span><span class="p">,)</span>
            <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTSET</span> <span class="k">else</span> <span class="n">default</span>
            <span class="k">assert</span> <span class="n">implicit</span> <span class="ow">is</span> <span class="n">NOTSET</span>
            <span class="k">assert</span> <span class="n">implicit_domain</span> <span class="ow">is</span> <span class="n">NOTSET</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="n">field</span><span class="p">,</span> <span class="n">attr</span> <span class="o">=</span> <span class="n">field</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">field</span>
            <span class="k">if</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">field</span><span class="p">]</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
                <span class="n">kwds</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">NOTSET</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwds</span><span class="p">[</span><span class="n">field</span><span class="p">]</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()[</span><span class="n">field</span><span class="p">]</span>

        <span class="c1"># Initialize the new config object</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">):</span>
            <span class="n">ans</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Copy over any Dict definitions</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">preserve_implicit</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">ans</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_tmp</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">preserve_implicit</span><span class="o">=</span><span class="n">preserve_implicit</span><span class="p">)</span>
                    <span class="n">ans</span><span class="o">.</span><span class="n">_decl_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span><span class="p">:</span>
                        <span class="n">ans</span><span class="o">.</span><span class="n">_declared</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                    <span class="n">_tmp</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">ans</span>
                    <span class="n">_tmp</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">_name</span>

        <span class="c1"># ... and set the value, if appropriate</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="n">ans</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span>

<div class="viewcode-block" id="ConfigBase.name"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.name">[docs]</a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fully_qualified</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Special case for the top-level dict</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">fully_qualified</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="n">fully_qualified</span><span class="p">)</span>
            <span class="c1"># Special case for ConfigList indexing and the top-level entries</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">pName</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pName</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pName</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span></div>

<div class="viewcode-block" id="ConfigBase.domain_name"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.domain_name">[docs]</a>    <span class="k">def</span> <span class="nf">domain_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_dn</span> <span class="o">=</span> <span class="n">_domain_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_dn</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_munge_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_dn</span></div>

<div class="viewcode-block" id="ConfigBase.set_default_value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.set_default_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default</span> <span class="o">=</span> <span class="n">default</span></div>

<div class="viewcode-block" id="ConfigBase.set_domain"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.set_domain">[docs]</a>    <span class="k">def</span> <span class="nf">set_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">accessValue</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_cast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NOTSET</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">):</span>
                    <span class="n">_dom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_dom</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;invalid value for configuration &#39;</span><span class="si">%s</span><span class="s2">&#39;:</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Failed casting </span><span class="si">%s</span><span class="se">\n\t</span><span class="s2">to </span><span class="si">%s</span><span class="se">\n\t</span><span class="s2">Error: </span><span class="si">%s</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">_dom</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

<div class="viewcode-block" id="ConfigBase.reset"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#</span>
        <span class="c1"># This is a dangerous construct, the failure in the first try block</span>
        <span class="c1"># can mask a real problem.</span>
        <span class="c1">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ConfigBase.declare_as_argument"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.declare_as_argument">[docs]</a>    <span class="k">def</span> <span class="nf">declare_as_argument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Map this Config item to an argparse argument.</span>

<span class="sd">        Valid arguments include all valid arguments to argparse&#39;s</span>
<span class="sd">        ArgumentParser.add_argument() with the exception of &#39;default&#39;.</span>
<span class="sd">        In addition, you may provide a group keyword argument to either</span>
<span class="sd">        pass in a pre-defined option group or subparser, or else pass in</span>
<span class="sd">        the string name of a group, subparser, or (subparser, group).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;default&#39;</span> <span class="ow">in</span> <span class="n">kwds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;You cannot specify an argparse default value with &quot;</span>
                <span class="s2">&quot;ConfigBase.declare_as_argument().  The default value is &quot;</span>
                <span class="s2">&quot;supplied automatically from the Config definition.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;action&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwds</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default</span><span class="p">:</span>
                <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;store_true&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;store_false&#39;</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
                    <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;--disable-&#39;</span> <span class="o">+</span> <span class="n">_munge_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()),)</span>
                <span class="k">if</span> <span class="s1">&#39;help&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwds</span><span class="p">:</span>
                    <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;[DON&#39;T] &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>
        <span class="k">if</span> <span class="s1">&#39;help&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwds</span><span class="p">:</span>
            <span class="n">kwds</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">_munge_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">()),)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_argparse</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_argparse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_argparse</span> <span class="o">+</span> <span class="p">((</span><span class="n">args</span><span class="p">,</span> <span class="n">kwds</span><span class="p">),)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_argparse</span> <span class="o">=</span> <span class="p">((</span><span class="n">args</span><span class="p">,</span> <span class="n">kwds</span><span class="p">),)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="ConfigBase.initialize_argparse"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.initialize_argparse">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_argparse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_get_subparser_or_group</span><span class="p">(</span><span class="n">_parser</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="c1"># Note: strings also have a &#39;title()&#39; method.  We are</span>
            <span class="c1"># looking for things that look like argparse</span>
            <span class="c1"># groups/subparsers, so just checking for the attribute</span>
            <span class="c1"># is insufficient: it needs to be a string attribute as</span>
            <span class="c1"># well</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">argparse</span><span class="o">.</span><span class="n">_ActionsContainer</span><span class="p">):</span>
                <span class="c1"># hasattr(_group, &#39;title&#39;) and \</span>
                <span class="c1">#    isinstance(_group.title, str):</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;Unknown datatype (</span><span class="si">%s</span><span class="s1">) for argparse group on &#39;</span>
                    <span class="s1">&#39;configuration definition </span><span class="si">%s</span><span class="s1">&#39;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
                <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_grp</span> <span class="ow">in</span> <span class="n">_parser</span><span class="o">.</span><span class="n">_subparsers</span><span class="o">.</span><span class="n">_group_actions</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">_grp</span><span class="o">.</span><span class="n">_name_parser_map</span><span class="p">:</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_grp</span><span class="o">.</span><span class="n">_name_parser_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">for</span> <span class="n">_grp</span> <span class="ow">in</span> <span class="n">_parser</span><span class="o">.</span><span class="n">_action_groups</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">_grp</span><span class="o">.</span><span class="n">title</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_grp</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_process_argparse_def</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_kwds</span><span class="p">):</span>
            <span class="n">_parser</span> <span class="o">=</span> <span class="n">parser</span>
            <span class="c1"># shallow copy the dict so we can remove the group flag and</span>
            <span class="c1"># add things like documentation, etc.</span>
            <span class="n">_kwds</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">_kwds</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;group&#39;</span> <span class="ow">in</span> <span class="n">_kwds</span><span class="p">:</span>
                <span class="n">_group</span> <span class="o">=</span> <span class="n">_kwds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_group</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">_idx</span><span class="p">,</span> <span class="n">_grp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_group</span><span class="p">):</span>
                        <span class="n">_issub</span><span class="p">,</span> <span class="n">_parser</span> <span class="o">=</span> <span class="n">_get_subparser_or_group</span><span class="p">(</span><span class="n">_parser</span><span class="p">,</span> <span class="n">_grp</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">_issub</span> <span class="ow">and</span> <span class="n">_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">_group</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                                <span class="s2">&quot;Could not find argparse subparser &#39;</span><span class="si">%s</span><span class="s2">&#39; for &quot;</span>
                                <span class="s2">&quot;Config item </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_grp</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
                            <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_issub</span><span class="p">,</span> <span class="n">_parser</span> <span class="o">=</span> <span class="n">_get_subparser_or_group</span><span class="p">(</span><span class="n">_parser</span><span class="p">,</span> <span class="n">_group</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;dest&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_kwds</span><span class="p">:</span>
                <span class="n">_kwds</span><span class="p">[</span><span class="s1">&#39;dest&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;CONFIGBLOCK.&#39;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="s1">&#39;metavar&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_kwds</span>
                    <span class="ow">and</span> <span class="n">_kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_store_bool</span>
                    <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">_domain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="n">_kwds</span><span class="p">[</span><span class="s1">&#39;metavar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">domain_name</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span> <span class="o">**</span><span class="n">_kwds</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_argparse</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_kwds</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">_argparse</span><span class="p">:</span>
                <span class="n">_process_argparse_def</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_kwds</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigBase.import_argparse"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.import_argparse">[docs]</a>    <span class="k">def</span> <span class="nf">import_argparse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsed_args</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_argparse</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">_args</span><span class="p">,</span> <span class="n">_kwds</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">_argparse</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;dest&#39;</span> <span class="ow">in</span> <span class="n">_kwds</span><span class="p">:</span>
                    <span class="n">_dest</span> <span class="o">=</span> <span class="n">_kwds</span><span class="p">[</span><span class="s1">&#39;dest&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">_dest</span> <span class="ow">in</span> <span class="n">parsed_args</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">_dest</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_dest</span> <span class="o">=</span> <span class="s1">&#39;CONFIGBLOCK.&#39;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">_dest</span> <span class="ow">in</span> <span class="n">parsed_args</span><span class="p">:</span>
                        <span class="n">obj</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">parsed_args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">_dest</span><span class="p">])</span>
                        <span class="k">del</span> <span class="n">parsed_args</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">_dest</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">parsed_args</span></div>

<div class="viewcode-block" id="ConfigBase.display"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.display">[docs]</a>    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">content_filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">indent_spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ostream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">content_filter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ConfigDict</span><span class="o">.</span><span class="n">content_filters</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;unknown content filter &#39;</span><span class="si">%s</span><span class="s2">&#39;; valid values are </span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">content_filter</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="o">.</span><span class="n">content_filters</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">_blocks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">ostream</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ostream</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="k">for</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">):</span>
            <span class="n">_str</span> <span class="o">=</span> <span class="n">_value2string</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="n">_blocks</span><span class="p">[</span><span class="n">lvl</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">indent_spacing</span> <span class="o">*</span> <span class="n">lvl</span> <span class="o">+</span> <span class="n">_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">content_filter</span> <span class="o">==</span> <span class="s1">&#39;userdata&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">_userSet</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">_blocks</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ostream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="n">_blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="ConfigBase.generate_yaml_template"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.generate_yaml_template">[docs]</a>    <span class="k">def</span> <span class="nf">generate_yaml_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent_spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">minDocWidth</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;  # &quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">))</span>
        <span class="n">level_info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">_str</span> <span class="o">=</span> <span class="n">_value2yaml</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lvl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">level_info</span><span class="p">:</span>
                <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;off&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;over&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
            <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="n">_str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">_str</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_description</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">lvl</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">level_info</span><span class="p">):</span>
            <span class="n">indent</span> <span class="o">=</span> <span class="n">lvl</span> <span class="o">*</span> <span class="n">indent_spacing</span>
            <span class="n">_ok</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="n">indent</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span> <span class="o">-</span> <span class="n">minDocWidth</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="n">val</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">_ok</span> <span class="k">else</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">indent</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">over</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="mi">1</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">doc</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">&gt;</span> <span class="n">width</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="n">over</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="n">offset</span> <span class="o">+</span> <span class="n">doc</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">doc</span> <span class="o">&lt;=</span> <span class="n">width</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">width</span>
            <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;off&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
            <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;over&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">over</span>
        <span class="n">maxLvl</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">maxDoc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pad</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">lvl</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">level_info</span><span class="p">):</span>
            <span class="n">_pad</span> <span class="o">=</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;off&#39;</span><span class="p">]</span>
            <span class="n">_doc</span> <span class="o">=</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">_pad</span>
            <span class="k">if</span> <span class="n">_pad</span> <span class="o">&gt;</span> <span class="n">pad</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">maxDoc</span> <span class="o">+</span> <span class="n">_pad</span> <span class="o">&lt;=</span> <span class="n">width</span><span class="p">:</span>
                    <span class="n">pad</span> <span class="o">=</span> <span class="n">_pad</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">_doc</span> <span class="o">+</span> <span class="n">pad</span> <span class="o">&gt;</span> <span class="n">width</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">_doc</span> <span class="o">&gt;</span> <span class="n">maxDoc</span><span class="p">:</span>
                <span class="n">maxDoc</span> <span class="o">=</span> <span class="n">_doc</span>
            <span class="n">maxLvl</span> <span class="o">=</span> <span class="n">lvl</span>
        <span class="n">os</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">comment</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_description</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">lvl</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">_str</span> <span class="o">=</span> <span class="n">_value2yaml</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">_description</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">indent_spacing</span> <span class="o">*</span> <span class="n">lvl</span> <span class="o">+</span> <span class="n">_str</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">lvl</span> <span class="o">&lt;=</span> <span class="n">maxLvl</span><span class="p">:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">pad</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">field</span> <span class="o">=</span> <span class="n">level_info</span><span class="p">[</span><span class="n">lvl</span><span class="p">][</span><span class="s1">&#39;off&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">indent_spacing</span> <span class="o">*</span> <span class="n">lvl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">width</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">_str</span><span class="p">)</span> <span class="o">-</span> <span class="n">minDocWidth</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%%</span><span class="s1">-</span><span class="si">%d</span><span class="s1">s&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">field</span> <span class="o">-</span> <span class="n">indent_spacing</span> <span class="o">*</span> <span class="n">lvl</span><span class="p">)</span> <span class="o">%</span> <span class="n">_str</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_str</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">field</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">txtArea</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="n">field</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">comment</span><span class="p">),</span> <span class="n">minDocWidth</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">field</span> <span class="o">+</span> <span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">_description</span><span class="p">,</span> <span class="n">txtArea</span><span class="p">,</span> <span class="n">subsequent_indent</span><span class="o">=</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span></div>

<div class="viewcode-block" id="ConfigBase.generate_documentation"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.generate_documentation">[docs]</a>    <span class="k">def</span> <span class="nf">generate_documentation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">block_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">block_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">item_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">item_body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">item_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">indent_spacing</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">78</span><span class="p">,</span>
        <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;latex&#39;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">ConfigFormatter</span><span class="o">.</span><span class="n">formats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">formatter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized documentation formatter, &#39;</span><span class="si">{</span><span class="nb">format</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Assume everything not a str is a valid formatter object.</span>
            <span class="n">formatter</span> <span class="o">=</span> <span class="nb">format</span>

        <span class="n">deprecated_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">block_start</span><span class="p">,</span> <span class="n">block_end</span><span class="p">,</span> <span class="n">item_start</span><span class="p">,</span> <span class="n">item_end</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">deprecated_args</span><span class="p">):</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;block_start&#39;</span><span class="p">,</span> <span class="s1">&#39;block_end&#39;</span><span class="p">,</span> <span class="s1">&#39;item_start&#39;</span><span class="p">,</span> <span class="s1">&#39;item_end&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">arg</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">deprecated_args</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">deprecation_warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Overriding &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; by passing strings to &quot;</span>
                    <span class="s2">&quot;generate_documentation is deprecated.  Create an instance of a &quot;</span>
                    <span class="s2">&quot;StringConfigFormatter and pass it as the &#39;format&#39; argument.&quot;</span><span class="p">,</span>
                    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">formatter</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">_formatter_str_to_callback</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">formatter</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="n">item_body</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">deprecation_warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Overriding &#39;item_body&#39; by passing strings to &quot;</span>
                <span class="s2">&quot;generate_documentation is deprecated.  Create an instance of a &quot;</span>
                <span class="s2">&quot;StringConfigFormatter and pass it as the &#39;format&#39; argument.&quot;</span><span class="p">,</span>
                <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span>
                <span class="n">formatter</span><span class="p">,</span>
                <span class="s2">&quot;_item_body&quot;</span><span class="p">,</span>
                <span class="n">_formatter_str_to_item_callback</span><span class="p">(</span><span class="n">item_body</span><span class="p">,</span> <span class="n">formatter</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">formatter</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indent_spacing</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">visibility</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigBase.user_values"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.user_values">[docs]</a>    <span class="k">def</span> <span class="nf">user_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_userSet</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="ConfigBase.unused_user_values"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigBase.unused_user_values">[docs]</a>    <span class="k">def</span> <span class="nf">unused_user_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">_userSet</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">_userAccessed</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="ConfigValue"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigValue">[docs]</a><span class="k">class</span> <span class="nc">ConfigValue</span><span class="p">(</span><span class="n">ConfigBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store and manipulate a single configuration value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    default: optional</span>
<span class="sd">        The default value that this ConfigValue will take if no value is</span>
<span class="sd">        provided.</span>

<span class="sd">    domain: Callable, optional</span>
<span class="sd">        The domain can be any callable that accepts a candidate value</span>
<span class="sd">        and returns the value converted to the desired type, optionally</span>
<span class="sd">        performing any data validation.  The result will be stored into</span>
<span class="sd">        the ConfigValue.  Examples include type constructors like `int`</span>
<span class="sd">        or `float`.  More complex domain examples include callable</span>
<span class="sd">        objects; for example, the :py:class:`In` class that ensures that</span>
<span class="sd">        the value falls into an acceptable set or even a complete</span>
<span class="sd">        :py:class:`ConfigDict` instance.</span>

<span class="sd">    description: str, optional</span>
<span class="sd">        The short description of this value</span>

<span class="sd">    doc: str, optional</span>
<span class="sd">        The long documentation string for this value</span>

<span class="sd">    visibility: int, optional</span>
<span class="sd">        The visibility of this ConfigValue when generating templates and</span>
<span class="sd">        documentation.  Visibility supports specification of &quot;advanced&quot;</span>
<span class="sd">        or &quot;developer&quot; options.  ConfigValues with visibility=0 (the</span>
<span class="sd">        default) will always be printed / included.  ConfigValues</span>
<span class="sd">        with higher visibility values will only be included when the</span>
<span class="sd">        generation method specifies a visibility greater than or equal</span>
<span class="sd">        to the visibility of this object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">ConfigBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<div class="viewcode-block" id="ConfigValue.value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigValue.value">[docs]</a>    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accessValue</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">accessValue</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span></div>

<div class="viewcode-block" id="ConfigValue.set_value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigValue.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># Trap self-assignment (useful for providing editor completion)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_data_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">docMode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">visibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">visibility</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">ImmutableConfigValue</span><span class="p">(</span><span class="n">ConfigValue</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="c1"># ImmutableConfigValue objects are never directly created, and</span>
        <span class="c1"># any attempt to copy one will generate a mutable ConfigValue</span>
        <span class="c1"># object</span>
        <span class="k">return</span> <span class="n">ConfigValue</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; is currently immutable&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ImmutableConfigValue</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MarkImmutable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mark instances of ConfigValue as immutable.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    config_value: ConfigValue</span>
<span class="sd">        The ConfigValue instances that should be marked immutable.</span>
<span class="sd">        Note that multiple instances of ConfigValue can be passed.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; config = ConfigDict()</span>
<span class="sd">    &gt;&gt;&gt; config.declare(&#39;a&#39;, ConfigValue(default=1, domain=int))</span>
<span class="sd">    &gt;&gt;&gt; config.declare(&#39;b&#39;, ConfigValue(default=1, domain=int))</span>
<span class="sd">    &gt;&gt;&gt; locker = MarkImmutable(config.get(&#39;a&#39;), config.get(&#39;b&#39;))</span>

<span class="sd">    Now, config.a and config.b cannot be changed. To make them mutable again,</span>

<span class="sd">    &gt;&gt;&gt; locker.release_lock()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cfg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_targets</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ConfigValue</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">&#39;Only ConfigValue instances can be marked immutable.&#39;</span>
                    <span class="p">)</span>
                <span class="n">cfg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">ImmutableConfigValue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">release_lock</span><span class="p">()</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">release_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span><span class="p">:</span>
            <span class="n">arg</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">ConfigValue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_locked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">release_lock</span><span class="p">()</span>


<div class="viewcode-block" id="ConfigList"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList">[docs]</a><span class="k">class</span> <span class="nc">ConfigList</span><span class="p">(</span><span class="n">ConfigBase</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store and manipulate a list of configuration values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    default: optional</span>
<span class="sd">        The default value that this ConfigList will take if no value is</span>
<span class="sd">        provided.  If default is a list or ConfigList, then each member</span>
<span class="sd">        is cast to the ConfigList&#39;s domain to build the default value,</span>
<span class="sd">        otherwise the default is cast to the domain and forms a default</span>
<span class="sd">        list with a single element.</span>

<span class="sd">    domain: Callable, optional</span>
<span class="sd">        The domain can be any callable that accepts a candidate value</span>
<span class="sd">        and returns the value converted to the desired type, optionally</span>
<span class="sd">        performing any data validation.  The result will be stored /</span>
<span class="sd">        added to the ConfigList.  Examples include type constructors</span>
<span class="sd">        like `int` or `float`.  More complex domain examples include</span>
<span class="sd">        callable objects; for example, the :py:class:`In` class that</span>
<span class="sd">        ensures that the value falls into an acceptable set or even a</span>
<span class="sd">        complete :py:class:`ConfigDict` instance.</span>

<span class="sd">    description: str, optional</span>
<span class="sd">        The short description of this list</span>

<span class="sd">    doc: str, optional</span>
<span class="sd">        The long documentation string for this list</span>

<span class="sd">    visibility: int, optional</span>
<span class="sd">        The visibility of this ConfigList when generating templates and</span>
<span class="sd">        documentation.  Visibility supports specification of &quot;advanced&quot;</span>
<span class="sd">        or &quot;developer&quot; options.  ConfigLists with visibility=0 (the</span>
<span class="sd">        default) will always be printed / included.  ConfigLists</span>
<span class="sd">        with higher visibility values will only be included when the</span>
<span class="sd">        generation method specifies a visibility greater than or equal</span>
<span class="sd">        to the visibility of this object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">ConfigBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">ConfigValue</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">,</span> <span class="n">ConfigBase</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span> <span class="o">=</span> <span class="n">ConfigValue</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ConfigList</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">ConfigValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>

<div class="viewcode-block" id="ConfigList.get"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="c1"># Note: get() is borrowed from ConfigDict for cases where we</span>
        <span class="c1"># want the raw stored object (and to avoid the implicit</span>
        <span class="c1"># conversion of ConfigValue members to their stored data).</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
                <span class="k">raise</span>
        <span class="c1"># Note: self._domain is ALWAYS derived from ConfigBase</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="p">(</span><span class="n">default</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="c1"># Note: this will fail if the element doesn&#39;t exist in _data.</span>
        <span class="c1"># As a result, *this* list doesn&#39;t change when someone tries to</span>
        <span class="c1"># change an element; instead, the *element* gets its _userSet</span>
        <span class="c1"># flag set.</span>
        <span class="c1"># self._userSet = True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)))</span>

<div class="viewcode-block" id="ConfigList.value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.value">[docs]</a>    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accessValue</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">accessValue</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">accessValue</span><span class="p">)</span> <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">]</span></div>

<div class="viewcode-block" id="ConfigList.set_value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># If the set_value fails part-way through the list values, we</span>
        <span class="c1"># want to restore a deterministic state.  That is, either</span>
        <span class="c1"># set_value succeeds completely, or else nothing happens.</span>
        <span class="n">_old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_default_string_list_lexer</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ConfigList</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">_old</span>
            <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ConfigList.reset"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ConfigBase</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Because the base reset() calls set_value, any deefault list</span>
        <span class="c1"># entries will get their userSet flag set.  This is wrong, as</span>
        <span class="c1"># reset() should conceptually reset the object to it&#39;s default</span>
        <span class="c1"># state (e.g., before the user ever had a chance to mess with</span>
        <span class="c1"># things).  As the list could contain a ConfigDict, this is a</span>
        <span class="c1"># recursive operation to put the userSet values back.</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_values</span><span class="p">():</span>
            <span class="n">val</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ConfigList.append"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cast</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">True</span></div>
        <span class="c1"># Adding something to the container should not change the</span>
        <span class="c1"># userSet on the container (see Pyomo/pyomo#352; now</span>
        <span class="c1"># Pyomo/pysp#8 for justification)</span>
        <span class="c1"># self._userSet = True</span>

<div class="viewcode-block" id="ConfigList.add"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigList.add">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;ConfigList.add() has been deprecated.  Use append()&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;5.7.2&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="s2">&quot;Append the specified value to the list, casting as necessary.&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_data_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">docMode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">visibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">visibility</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">docMode</span><span class="p">:</span>
            <span class="c1"># In documentation mode, we do NOT list the documentation</span>
            <span class="c1"># for any sub-data, and instead document the *domain*</span>
            <span class="c1"># information (as all the entries should share the same</span>
            <span class="c1"># domain, potentially duplicating that documentation is</span>
            <span class="c1"># somewhat redundant, and worse, if the list is empty, then</span>
            <span class="c1"># no documentation is generated at all!)</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">subDomain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_domain</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span>
                <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;- &#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="n">docMode</span>
            <span class="p">)</span>
            <span class="c1"># Pop off the (empty) block entry</span>
            <span class="nb">next</span><span class="p">(</span><span class="n">subDomain</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">subDomain</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">v</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="p">[],</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="s1">&#39;- &#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="n">docMode</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">v</span></div>


<div class="viewcode-block" id="ConfigDict"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict">[docs]</a><span class="k">class</span> <span class="nc">ConfigDict</span><span class="p">(</span><span class="n">ConfigBase</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store and manipulate a dictionary of configuration values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    description: str, optional</span>
<span class="sd">        The short description of this list</span>

<span class="sd">    doc: str, optional</span>
<span class="sd">        The long documentation string for this list</span>

<span class="sd">    implicit: bool, optional</span>
<span class="sd">        If True, the ConfigDict will allow &quot;implicitly&quot; declared</span>
<span class="sd">        keys, that is, keys can be stored into the ConfigDict that</span>
<span class="sd">        were not previously declared using :py:meth:`declare` or</span>
<span class="sd">        :py:meth:`declare_from`.</span>

<span class="sd">    implicit_domain: Callable, optional</span>
<span class="sd">        The domain that will be used for any implicitly-declared keys.</span>
<span class="sd">        Follows the same rules as :py:meth:`ConfigValue`&#39;s `domain`.</span>

<span class="sd">    visibility: int, optional</span>
<span class="sd">        The visibility of this ConfigDict when generating templates and</span>
<span class="sd">        documentation.  Visibility supports specification of &quot;advanced&quot;</span>
<span class="sd">        or &quot;developer&quot; options.  ConfigDicts with visibility=0 (the</span>
<span class="sd">        default) will always be printed / included.  ConfigDicts</span>
<span class="sd">        with higher visibility values will only be included when the</span>
<span class="sd">        generation method specifies a visibility greater than or equal</span>
<span class="sd">        to the visibility of this object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">content_filters</span> <span class="o">=</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;userdata&#39;</span><span class="p">}</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;_decl_order&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_declared&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_implicit_declaration&#39;</span><span class="p">,</span>
        <span class="s1">&#39;_implicit_domain&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">_all_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="vm">__slots__</span> <span class="o">+</span> <span class="n">ConfigBase</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">implicit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">implicit_domain</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">visibility</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_declaration</span> <span class="o">=</span> <span class="n">implicit</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">implicit_domain</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">implicit_domain</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DynamicImplicitDomain</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">implicit_domain</span><span class="p">,</span> <span class="n">ConfigBase</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span> <span class="o">=</span> <span class="n">implicit_domain</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span> <span class="o">=</span> <span class="n">ConfigValue</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">implicit_domain</span><span class="p">)</span>
        <span class="n">ConfigBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{},</span> <span class="n">description</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">visibility</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="ConfigDict.domain_name"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.domain_name">[docs]</a>    <span class="k">def</span> <span class="nf">domain_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_munge_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ConfigDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>
        <span class="n">state</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ConfigDict</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_implicit_domain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_picklable</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">&#39;_implicit_domain&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ConfigDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__setstate__</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">x</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Note that dir() returns the *normalized* names (i.e., no spaces)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">super</span><span class="p">(</span><span class="n">ConfigDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">()</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">],</span> <span class="n">ConfigValue</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span>

<div class="viewcode-block" id="ConfigDict.get"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DynamicImplicitDomain</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ConfigValue</span><span class="p">(</span><span class="n">default</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigDict.setdefault"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.setdefault">[docs]</a>    <span class="k">def</span> <span class="nf">setdefault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">NOTSET</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">NOTSET</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c1"># self._userAccessed = True</span>

    <span class="k">def</span> <span class="fm">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="c1"># Note that this will produce a KeyError if the key is not valid</span>
        <span class="c1"># for this ConfigDict.</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span>
        <span class="c1"># Clean up the other data structures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">_key</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">_key</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">_name</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># Note: __getattr__ is only called after all &quot;usual&quot; attribute</span>
        <span class="c1"># lookup methods have failed.  So, if we get here, we already</span>
        <span class="c1"># know that key is not a __slot__ or a method, etc...</span>
        <span class="c1"># if name in ConfigDict._all_slots:</span>
        <span class="c1">#    return super(ConfigDict,self).__getattribute__(name)</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Unknown attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ConfigDict</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ConfigDict</span><span class="o">.</span><span class="n">_all_slots</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">ConfigDict</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ConfigDict</span><span class="o">.</span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">_key</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; object attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; is read-only&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>

<div class="viewcode-block" id="ConfigDict.keys"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigDict.values"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></div>

<div class="viewcode-block" id="ConfigDict.items"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">:</span>
            <span class="k">yield</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">_name</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span></div>

<div class="viewcode-block" id="ConfigDict.iterkeys"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.iterkeys">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="s1">&#39;The iterkeys method is deprecated. Use dict.keys().&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.0&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">iterkeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></div>

<div class="viewcode-block" id="ConfigDict.itervalues"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.itervalues">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="s1">&#39;The itervalues method is deprecated. Use dict.keys().&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.0&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">itervalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span></div>

<div class="viewcode-block" id="ConfigDict.iteritems"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.iteritems">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span><span class="s1">&#39;The iteritems method is deprecated. Use dict.keys().&#39;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.0&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">iteritems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;config &#39;</span><span class="si">%s</span><span class="s2">&#39; is already assigned to ConfigDict &#39;</span><span class="si">%s</span><span class="s2">&#39;; &quot;</span>
                <span class="s2">&quot;cannot reassign to &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;duplicate config &#39;</span><span class="si">%s</span><span class="s2">&#39; defined for ConfigDict &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_name</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">config</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">config</span>

<div class="viewcode-block" id="ConfigDict.declare"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.declare">[docs]</a>    <span class="k">def</span> <span class="nf">declare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="ConfigDict.declare_from"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.declare_from">[docs]</a>    <span class="k">def</span> <span class="nf">declare_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ConfigDict.declare_from() only accepts other ConfigDicts&quot;</span><span class="p">)</span>
        <span class="c1"># Note that we duplicate [&quot;other()&quot;] other so that this</span>
        <span class="c1"># ConfigDict&#39;s entries are independent of the other&#39;s</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">skip</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;ConfigDict.declare_from passed a block &quot;</span>
                    <span class="s2">&quot;with a duplicate field, &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">declare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)())</span></div>

<div class="viewcode-block" id="ConfigDict.add"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_declaration</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Key &#39;</span><span class="si">%s</span><span class="s2">&#39; not defined in ConfigDict &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span>
                <span class="s2">&quot; and Dict disallows implicit entries&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">ConfigBase</span><span class="p">):</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ConfigValue</span><span class="p">(</span><span class="n">config</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DynamicImplicitDomain</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">config</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_domain</span><span class="p">(</span><span class="n">config</span><span class="p">))</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Adding something to the container should not change the</span>
        <span class="c1"># userSet on the container (see Pyomo/pyomo#352; now</span>
        <span class="c1"># Pyomo/pysp#8 for justification)</span>
        <span class="c1"># self._userSet = True</span>
        <span class="k">return</span> <span class="n">ans</span></div>

<div class="viewcode-block" id="ConfigDict.value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.value">[docs]</a>    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accessValue</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">accessValue</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span> <span class="n">cfg</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">accessValue</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cfg</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">)</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ConfigDict.set_value"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.set_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">skip_implicit</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">_default_string_dict_lexer</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ConfigDict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Expected dict value for </span><span class="si">%s</span><span class="s2">.set_value, found </span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">_implicit</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_decl_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">:</span>
                <span class="c1"># str(key) may not be key... store the mapping so that</span>
                <span class="c1"># when we later iterate over the _decl_order, we can map</span>
                <span class="c1"># the local keys back to the incoming value keys.</span>
                <span class="n">_decl_map</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">skip_implicit</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_implicit_declaration</span><span class="p">:</span>
                    <span class="n">_implicit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;key &#39;</span><span class="si">%s</span><span class="s2">&#39; not defined for ConfigDict &#39;</span><span class="si">%s</span><span class="s2">&#39; and &quot;</span>
                        <span class="s2">&quot;implicit (undefined) keys are not allowed&quot;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>
                    <span class="p">)</span>

        <span class="c1"># If the set_value fails part-way through the new values, we</span>
        <span class="c1"># want to restore a deterministic state.  That is, either</span>
        <span class="c1"># set_value succeeds completely, or else nothing happens.</span>
        <span class="n">_old_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># We want to set the values in declaration order (so that</span>
            <span class="c1"># things are deterministic and in case a validation depends</span>
            <span class="c1"># on the order)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_decl_map</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">_decl_map</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
            <span class="c1"># implicit data is declared at the end (in sorted order)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">_implicit</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">_old_data</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="ConfigDict.reset"><a class="viewcode-back" href="../../../library_reference/common/config.html#pyomo.contrib.appsi.base.ConfigDict.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset the values in the order they were declared.  This</span>
        <span class="c1"># allows reset functions to have a deterministic ordering.</span>
        <span class="k">def</span> <span class="nf">_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
            <span class="n">keep</span> <span class="o">=</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_declared</span>
            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">keep</span>

        <span class="c1"># this is an in-place slice of a list...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span> <span class="k">if</span> <span class="n">_keep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userAccessed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_userSet</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">_data_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">visibility</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">docMode</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">visibility</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">visibility</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visibility</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">prefix</span><span class="p">:</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decl_order</span><span class="p">:</span>
            <span class="n">cfg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">yield from</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_data_collector</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">_name</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="n">visibility</span><span class="p">,</span> <span class="n">docMode</span><span class="p">)</span></div>


<span class="c1"># Backwards compatibility: ConfigDict was originally named ConfigBlock.</span>
<span class="n">ConfigBlock</span> <span class="o">=</span> <span class="n">ConfigDict</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2008-2023, Sandia National Laboratories.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>