

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyomo.core.expr.numvalue &mdash; Pyomo 6.5.1.dev0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Pyomo
          

          
          </a>

          
            
            
              <div class="version">
                6.5.1.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citing_pyomo.html">Citing Pyomo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pyomo_overview/index.html">Pyomo Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../pyomo_modeling_components/index.html">Pyomo Modeling Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../solving_pyomo_models.html">Solving Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../working_models.html">Working with Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../working_abstractmodels/index.html">Working with Abstract Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../model_transformations/index.html">Model Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../modeling_extensions/index.html">Modeling Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial_examples.html">Pyomo Tutorial Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../model_debugging/index.html">Debugging Pyomo Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../advanced_topics/index.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../errors.html">Common Warnings/Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer_reference/index.html">Developer Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../library_reference/index.html">Library Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribution_guide.html">Contributing to Pyomo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributed_packages/index.html">Third-Party Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../related_packages.html">Related Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Pyomo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyomo.core.expr.numvalue</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyomo.core.expr.numvalue</h1><div class="highlight"><pre>
<span></span><span class="c1">#  ___________________________________________________________________________</span>
<span class="c1">#</span>
<span class="c1">#  Pyomo: Python Optimization Modeling Objects</span>
<span class="c1">#  Copyright (c) 2008-2022</span>
<span class="c1">#  National Technology and Engineering Solutions of Sandia, LLC</span>
<span class="c1">#  Under the terms of Contract DE-NA0003525 with National Technology and</span>
<span class="c1">#  Engineering Solutions of Sandia, LLC, the U.S. Government retains certain</span>
<span class="c1">#  rights in this software.</span>
<span class="c1">#  This software is distributed under the 3-clause BSD License.</span>
<span class="c1">#  ___________________________________________________________________________</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;value&#39;</span><span class="p">,</span>
    <span class="s1">&#39;is_constant&#39;</span><span class="p">,</span>
    <span class="s1">&#39;is_fixed&#39;</span><span class="p">,</span>
    <span class="s1">&#39;is_variable_type&#39;</span><span class="p">,</span>
    <span class="s1">&#39;is_potentially_variable&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NumericValue&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ZeroConstant&#39;</span><span class="p">,</span>
    <span class="s1">&#39;native_numeric_types&#39;</span><span class="p">,</span>
    <span class="s1">&#39;native_types&#39;</span><span class="p">,</span>
    <span class="s1">&#39;nonpyomo_leaf_types&#39;</span><span class="p">,</span>
    <span class="s1">&#39;polynomial_degree&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">pyomo.common.dependencies</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span><span class="p">,</span> <span class="n">numpy_available</span>
<span class="kn">from</span> <span class="nn">pyomo.common.deprecation</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">deprecated</span><span class="p">,</span>
    <span class="n">deprecation_warning</span><span class="p">,</span>
    <span class="n">relocated_module_attribute</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyomo.common.errors</span> <span class="kn">import</span> <span class="n">PyomoException</span>
<span class="kn">from</span> <span class="nn">pyomo.core.expr.expr_common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_add</span><span class="p">,</span>
    <span class="n">_sub</span><span class="p">,</span>
    <span class="n">_mul</span><span class="p">,</span>
    <span class="n">_div</span><span class="p">,</span>
    <span class="n">_pow</span><span class="p">,</span>
    <span class="n">_neg</span><span class="p">,</span>
    <span class="n">_abs</span><span class="p">,</span>
    <span class="n">_radd</span><span class="p">,</span>
    <span class="n">_rsub</span><span class="p">,</span>
    <span class="n">_rmul</span><span class="p">,</span>
    <span class="n">_rdiv</span><span class="p">,</span>
    <span class="n">_rpow</span><span class="p">,</span>
    <span class="n">_iadd</span><span class="p">,</span>
    <span class="n">_isub</span><span class="p">,</span>
    <span class="n">_imul</span><span class="p">,</span>
    <span class="n">_idiv</span><span class="p">,</span>
    <span class="n">_ipow</span><span class="p">,</span>
    <span class="n">_lt</span><span class="p">,</span>
    <span class="n">_le</span><span class="p">,</span>
    <span class="n">_eq</span><span class="p">,</span>
    <span class="n">ExpressionType</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">import</span> <span class="nn">pyomo.common.numeric_types</span> <span class="k">as</span> <span class="nn">_numeric_types</span>

<span class="c1"># TODO: update Pyomo to import these objects from common.numeric_types</span>
<span class="c1">#   (and not from here)</span>
<span class="kn">from</span> <span class="nn">pyomo.common.numeric_types</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">nonpyomo_leaf_types</span><span class="p">,</span>
    <span class="n">native_types</span><span class="p">,</span>
    <span class="n">native_numeric_types</span><span class="p">,</span>
    <span class="n">native_integer_types</span><span class="p">,</span>
    <span class="n">native_logical_types</span><span class="p">,</span>
    <span class="n">pyomo_constant_types</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyomo.core.pyomoobject</span> <span class="kn">import</span> <span class="n">PyomoObject</span>
<span class="kn">from</span> <span class="nn">pyomo.core.expr.expr_errors</span> <span class="kn">import</span> <span class="n">TemplateExpressionError</span>

<span class="n">relocated_module_attribute</span><span class="p">(</span>
    <span class="s1">&#39;native_boolean_types&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyomo.common.numeric_types._native_boolean_types&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
    <span class="n">f_globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">(),</span>
    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;The native_boolean_types set will be removed in the future: the set &quot;</span>
    <span class="s2">&quot;contains types that were convertible to bool, and not types that should &quot;</span>
    <span class="s2">&quot;be treated as if they were bool (as was the case for the other &quot;</span>
    <span class="s2">&quot;native_*_types sets).  Users likely should use native_logical_types.&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">relocated_module_attribute</span><span class="p">(</span>
    <span class="s1">&#39;RegisterNumericType&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyomo.common.numeric_types.RegisterNumericType&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
    <span class="n">f_globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">relocated_module_attribute</span><span class="p">(</span>
    <span class="s1">&#39;RegisterIntegerType&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyomo.common.numeric_types.RegisterIntegerType&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
    <span class="n">f_globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">(),</span>
<span class="p">)</span>
<span class="n">relocated_module_attribute</span><span class="p">(</span>
    <span class="s1">&#39;RegisterBooleanType&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pyomo.common.numeric_types.RegisterBooleanType&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.5.1.dev0&#39;</span><span class="p">,</span>
    <span class="n">f_globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">(),</span>
<span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;pyomo.core&#39;</span><span class="p">)</span>


<span class="c1"># Stub in the dispatchers</span>
<span class="k">def</span> <span class="nf">_incomplete_import</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;incomplete import of Pyomo expression system&quot;</span><span class="p">)</span>


<span class="n">_add_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>
<span class="n">_mul_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>
<span class="n">_div_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>
<span class="n">_pow_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>
<span class="n">_neg_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>
<span class="n">_abs_dispatcher</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">_incomplete_import</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_generate_relational_expression</span><span class="p">(</span><span class="n">etype</span><span class="p">,</span> <span class="n">lhs</span><span class="p">,</span> <span class="n">rhs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;incomplete import of Pyomo expression system&quot;</span><span class="p">)</span>


<span class="c1">##------------------------------------------------------------------------</span>
<span class="c1">##</span>
<span class="c1">## Standard types of expressions</span>
<span class="c1">##</span>
<span class="c1">##------------------------------------------------------------------------</span>


<span class="k">class</span> <span class="nc">NonNumericValue</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An object that contains a non-numeric value</span>

<span class="sd">    Constructor Arguments:</span>
<span class="sd">        value           The initial value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>


<span class="n">nonpyomo_leaf_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">NonNumericValue</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns the value of a Pyomo object or</span>
<span class="sd">    expression.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: The argument to evaluate. If it is None, a</span>
<span class="sd">            string, or any other primitive numeric type,</span>
<span class="sd">            then this function simply returns the argument.</span>
<span class="sd">            Otherwise, if the argument is a NumericValue</span>
<span class="sd">            then the __call__ method is executed.</span>
<span class="sd">        exception (bool): If :const:`True`, then an exception should</span>
<span class="sd">            be raised when instances of NumericValue fail to</span>
<span class="sd">            evaluate due to one or more objects not being</span>
<span class="sd">            initialized to a numeric value (e.g, one or more</span>
<span class="sd">            variables in an algebraic expression having the</span>
<span class="sd">            value None). If :const:`False`, then the function</span>
<span class="sd">            returns :const:`None` when an exception occurs.</span>
<span class="sd">            Default is True.</span>

<span class="sd">    Returns: A numeric value or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">pyomo_constant_types</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># I&#39;m commenting this out for now, but I think we should never expect</span>
        <span class="c1"># to see a numeric constant with value None.</span>
        <span class="c1">#</span>
        <span class="c1"># if exception and obj.value is None:</span>
        <span class="c1">#    raise ValueError(</span>
        <span class="c1">#        &quot;No value for uninitialized NumericConstant object %s&quot;</span>
        <span class="c1">#        % (obj.name,))</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span>
    <span class="c1">#</span>
    <span class="c1"># Test if we have a duck typed Pyomo expression</span>
    <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">is_numeric_type</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># TODO: Historically we checked for new *numeric* types and</span>
        <span class="c1"># raised exceptions for anything else.  That is inconsistent</span>
        <span class="c1"># with allowing native_types like None/str/bool to be returned</span>
        <span class="c1"># from value().  We should revisit if that is worthwhile to do</span>
        <span class="c1"># here.</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot evaluate object with unknown type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
    <span class="c1">#</span>
    <span class="c1"># Evaluate the expression object</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">exception</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Here, we try to catch the exception</span>
        <span class="c1">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">obj</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tmp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;No value for uninitialized NumericValue object </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">tmp</span>
        <span class="k">except</span> <span class="n">TemplateExpressionError</span><span class="p">:</span>
            <span class="c1"># Template expressions work by catching this error type. So</span>
            <span class="c1"># we should defer this error handling and not log an error</span>
            <span class="c1"># message.</span>
            <span class="k">raise</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;evaluating object as numeric value: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">    (object: </span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="k">raise</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># Here, we do not try to catch the exception</span>
        <span class="c1">#</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns a boolean that indicates</span>
<span class="sd">    whether the object is a constant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># JDS: NB: I am not sure why we allow str to be a constant, but</span>
    <span class="c1"># since we have historically done so, we check for type membership</span>
    <span class="c1"># in native_types and not in native_numeric_types.</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_constant</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Now we need to confirm that we have an unknown numeric type</span>
    <span class="c1">#</span>
    <span class="c1"># As this branch is only hit for previously unknown (to Pyomo)</span>
    <span class="c1"># types that behave reasonably like numbers, we know they *must*</span>
    <span class="c1"># be constant.</span>
    <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot assess properties of object with unknown type: </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,)</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">is_fixed</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns a boolean that indicates</span>
<span class="sd">    whether the input object&#39;s value is fixed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># JDS: NB: I am not sure why we allow str to be a constant, but</span>
    <span class="c1"># since we have historically done so, we check for type membership</span>
    <span class="c1"># in native_types and not in native_numeric_types.</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_fixed</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Now we need to confirm that we have an unknown numeric type</span>
    <span class="c1">#</span>
    <span class="c1"># As this branch is only hit for previously unknown (to Pyomo)</span>
    <span class="c1"># types that behave reasonably like numbers, we know they *must*</span>
    <span class="c1"># be fixed.</span>
    <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot assess properties of object with unknown type: </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,)</span>
        <span class="p">)</span>


<span class="k">def</span> <span class="nf">is_variable_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns a boolean indicating</span>
<span class="sd">    whether the input object is a variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_variable_type</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">is_potentially_variable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns a boolean indicating</span>
<span class="sd">    whether the input object can reference variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_potentially_variable</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="k">def</span> <span class="nf">is_numeric_data</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns a boolean indicating</span>
<span class="sd">    whether the input object is numeric and not potentially</span>
<span class="sd">    variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_numeric_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="c1"># this likely means it is a string</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Test if this is an expression object that</span>
        <span class="c1"># is not potentially variable</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_potentially_variable</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Now we need to confirm that we have an unknown numeric type</span>
    <span class="c1">#</span>
    <span class="c1"># As this branch is only hit for previously unknown (to Pyomo)</span>
    <span class="c1"># types that behave reasonably like numbers, we know they *must*</span>
    <span class="c1"># be numeric data (unless an exception is raised).</span>
    <span class="k">return</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">polynomial_degree</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A utility function that returns an integer</span>
<span class="sd">    that indicates the polynomial degree for an</span>
<span class="sd">    object. boolean indicating</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_numeric_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot evaluate the polynomial degree of a non-numeric type: </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,)</span>
        <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">polynomial_degree</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1"># Now we need to confirm that we have an unknown numeric type</span>
    <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="c1"># As this branch is only hit for previously unknown (to Pyomo)</span>
        <span class="c1"># types that behave reasonably like numbers, we know they *must*</span>
        <span class="c1"># be a numeric constant.</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot assess properties of object with unknown type: </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,)</span>
        <span class="p">)</span>


<span class="c1">#</span>
<span class="c1"># It is very common to have only a few constants in a model, but those</span>
<span class="c1"># constants get repeated many times.  KnownConstants lets us re-use /</span>
<span class="c1"># share constants we have seen before.</span>
<span class="c1">#</span>
<span class="c1"># Note:</span>
<span class="c1">#   For now, all constants are coerced to floats.  This avoids integer</span>
<span class="c1">#   division in Python 2.x.  (At least some of the time.)</span>
<span class="c1">#</span>
<span class="c1">#   When we eliminate support for Python 2.x, we will not need this</span>
<span class="c1">#   coercion.  The main difference in the following code is that we will</span>
<span class="c1">#   need to index KnownConstants by both the class type and value, since</span>
<span class="c1">#   INT, FLOAT and LONG values sometimes hash the same.</span>
<span class="c1">#</span>
<span class="n">_KnownConstants</span> <span class="o">=</span> <span class="p">{}</span>


<span class="k">def</span> <span class="nf">as_numeric</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A function that creates a NumericConstant object that</span>
<span class="sd">    wraps Python numeric values.</span>

<span class="sd">    This function also manages a cache of constants.</span>

<span class="sd">    NOTE:  This function is only intended for use when</span>
<span class="sd">        data is added to a component.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj: The numeric value that may be wrapped.</span>

<span class="sd">    Raises: TypeError if the object is in native_types and not in</span>
<span class="sd">        native_numeric_types</span>

<span class="sd">    Returns: A NumericConstant object or the original object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_numeric_types</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">_KnownConstants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span>
        <span class="c1">#</span>
        <span class="c1"># Coerce the value to a float, if possible</span>
        <span class="c1">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1">#</span>
        <span class="c1"># Create the numeric constant.  This really</span>
        <span class="c1"># should be the only place in the code</span>
        <span class="c1"># where these objects are constructed.</span>
        <span class="c1">#</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="n">NumericConstant</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Cache the numeric constants.  We used a bounded cache size</span>
        <span class="c1"># to avoid unexpectedly large lists of constants.  There are</span>
        <span class="c1"># typically a small number of constants that need to be cached.</span>
        <span class="c1">#</span>
        <span class="c1"># NOTE:  A LFU policy might be more sensible here, but that</span>
        <span class="c1"># requires a more complex cache.  It&#39;s not clear that that</span>
        <span class="c1"># is worth the extra cost.</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_KnownConstants</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
            <span class="c1"># obj may (or may not) be hashable, so we need this try</span>
            <span class="c1"># block so that things proceed normally for non-hashable</span>
            <span class="c1"># &quot;numeric&quot; types</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_KnownConstants</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">retval</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="c1">#</span>
        <span class="k">return</span> <span class="n">retval</span>
    <span class="c1">#</span>
    <span class="c1"># Ignore objects that are duck typed to work with Pyomo expressions</span>
    <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_numeric_type</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">elif</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_expression_type</span><span class="p">(</span><span class="n">ExpressionType</span><span class="o">.</span><span class="n">RELATIONAL</span><span class="p">):</span>
            <span class="n">deprecation_warning</span><span class="p">(</span>
                <span class="s2">&quot;returning a relational expression from as_numeric().  &quot;</span>
                <span class="s2">&quot;Relational expressions are no longer numeric types.  &quot;</span>
                <span class="s2">&quot;In the future this will raise a TypeError.&quot;</span><span class="p">,</span>
                <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.4.3&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;</span><span class="si">%s</span><span class="s2">&#39; object &#39;</span><span class="si">%s</span><span class="s2">&#39; is not a valid type for Pyomo &quot;</span>
                <span class="s2">&quot;numeric expressions&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">_name</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="c1">#</span>
    <span class="c1"># Test if the object looks like a number.  If so, re-call as_numeric</span>
    <span class="c1"># (this type will have been added to native_numeric_types).</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">as_numeric</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Generate errors</span>
    <span class="c1">#</span>
    <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> values (&#39;</span><span class="si">%s</span><span class="s2">&#39;) are not allowed in Pyomo &quot;</span>
            <span class="s2">&quot;numeric expressions&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
        <span class="s2">&quot;Cannot treat the value &#39;</span><span class="si">%s</span><span class="s2">&#39; as a numeric value because it has &quot;</span>
        <span class="s2">&quot;unknown type &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test if the argument behaves like a numeric type.</span>

<span class="sd">    We check for &quot;numeric types&quot; by checking if we can add zero to it</span>
<span class="sd">    without changing the object&#39;s type.  If that works, then we register</span>
<span class="sd">    the type in native_numeric_types.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj_class</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span>
    <span class="c1"># Do not re-evaluate known native types</span>
    <span class="k">if</span> <span class="n">obj_class</span> <span class="ow">in</span> <span class="n">native_types</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj_class</span> <span class="ow">in</span> <span class="n">native_numeric_types</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj_plus_0</span> <span class="o">=</span> <span class="n">obj</span> <span class="o">+</span> <span class="mi">0</span>
        <span class="n">obj_p0_class</span> <span class="o">=</span> <span class="n">obj_plus_0</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="c1"># ensure that the object is comparable to 0 in a meaningful way</span>
        <span class="c1"># (among other things, this prevents numpy.ndarray objects from</span>
        <span class="c1"># being added to native_numeric_types)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="n">obj</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">obj</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Native types *must* be hashable</span>
        <span class="nb">hash</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">obj_p0_class</span> <span class="ow">is</span> <span class="n">obj_class</span> <span class="ow">or</span> <span class="n">obj_p0_class</span> <span class="ow">in</span> <span class="n">native_numeric_types</span><span class="p">:</span>
        <span class="c1">#</span>
        <span class="c1"># If we get here, this is a reasonably well-behaving</span>
        <span class="c1"># numeric type: add it to the native numeric types</span>
        <span class="c1"># so that future lookups will be faster.</span>
        <span class="c1">#</span>
        <span class="n">_numeric_types</span><span class="o">.</span><span class="n">RegisterNumericType</span><span class="p">(</span><span class="n">obj_class</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Generate a warning, since Pyomo&#39;s management of third-party</span>
        <span class="c1"># numeric types is more robust when registering explicitly.</span>
        <span class="c1">#</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Dynamically registering the following numeric type:</span>
<span class="s2">    </span><span class="si">{</span><span class="n">obj_class</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">obj_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"></span>
<span class="s2">Dynamic registration is supported for convenience, but there are known</span>
<span class="s2">limitations to this approach.  We recommend explicitly registering</span>
<span class="s2">numeric types using RegisterNumericType() or RegisterIntegerType().&quot;&quot;&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="nd">@deprecated</span><span class="p">(</span>
    <span class="s2">&quot;check_if_numeric_type_and_cache() has been deprecated in &quot;</span>
    <span class="s2">&quot;favor of just calling as_numeric()&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.4.3&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">check_if_numeric_type_and_cache</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test if the argument is a numeric type by checking if we can add</span>
<span class="sd">    zero to it.  If that works, then we cache the value and return a</span>
<span class="sd">    NumericConstant object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">check_if_numeric_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">as_numeric</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj</span>


<div class="viewcode-block" id="NumericValue"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue">[docs]</a><span class="k">class</span> <span class="nc">NumericValue</span><span class="p">(</span><span class="n">PyomoObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the base class for numeric values used in Pyomo.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="c1"># This is required because we define __eq__</span>
    <span class="fm">__hash__</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="NumericValue.getname"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.getname">[docs]</a>    <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fully_qualified</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name_buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If this is a component, return the component&#39;s name on the owning</span>
<span class="sd">        block; otherwise return the value converted to a string</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_base</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">NumericValue</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">_base</span><span class="p">,</span> <span class="s1">&#39;getname&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_base</span><span class="o">.</span><span class="n">getname</span><span class="p">(</span><span class="n">fully_qualified</span><span class="p">,</span> <span class="n">name_buffer</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getname</span><span class="p">(</span><span class="n">fully_qualified</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">local_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getname</span><span class="p">(</span><span class="n">fully_qualified</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="NumericValue.is_numeric_type"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_numeric_type">[docs]</a>    <span class="k">def</span> <span class="nf">is_numeric_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if this class is a Pyomo numeric object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="NumericValue.is_constant"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_constant">[docs]</a>    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if this numeric value is a constant value&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumericValue.is_fixed"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_fixed">[docs]</a>    <span class="k">def</span> <span class="nf">is_fixed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if this is a non-constant value that has been fixed&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumericValue.is_potentially_variable"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_potentially_variable">[docs]</a>    <span class="k">def</span> <span class="nf">is_potentially_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if variables can appear in this expression&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumericValue.is_relational"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_relational">[docs]</a>    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;is_relational() is deprecated in favor of &quot;</span>
        <span class="s2">&quot;is_expression_type(ExpressionType.RELATIONAL)&quot;</span><span class="p">,</span>
        <span class="n">version</span><span class="o">=</span><span class="s1">&#39;6.4.3&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">is_relational</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if this numeric value represents a relational expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumericValue.is_indexed"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.is_indexed">[docs]</a>    <span class="k">def</span> <span class="nf">is_indexed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if this numeric value is an indexed object&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="NumericValue.polynomial_degree"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.polynomial_degree">[docs]</a>    <span class="k">def</span> <span class="nf">polynomial_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the polynomial degree of the expression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :const:`None`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_polynomial_degree</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue._compute_polynomial_degree"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue._compute_polynomial_degree">[docs]</a>    <span class="k">def</span> <span class="nf">_compute_polynomial_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the polynomial degree of this expression given</span>
<span class="sd">        the degree values of its children.</span>

<span class="sd">        Args:</span>
<span class="sd">            values (list): A list of values that indicate the degree</span>
<span class="sd">                of the children expression.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :const:`None`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="NumericValue.__bool__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__bool__">[docs]</a>    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Coerce the value to a bool</span>

<span class="sd">        Numeric values can be coerced to bool only if the value /</span>
<span class="sd">        expression is constant.  Fixed (but non-constant) or variable</span>
<span class="sd">        values will raise an exception.</span>

<span class="sd">        Raises:</span>
<span class="sd">            PyomoException</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note that we want to implement __bool__, as scalar numeric</span>
        <span class="c1"># components (e.g., Param, Var) implement __len__ (since they</span>
        <span class="c1"># are implicit containers), and Python falls back on __len__ if</span>
        <span class="c1"># __bool__ is not defined.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constant</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>
        <span class="k">raise</span> <span class="n">PyomoException</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Cannot convert non-constant Pyomo numeric value (%s) to bool.</span>
<span class="sd">This error is usually caused by using a Var, unit, or mutable Param in a</span>
<span class="sd">Boolean context such as an &quot;if&quot; statement. For example,</span>
<span class="sd">    &gt;&gt;&gt; m.x = Var()</span>
<span class="sd">    &gt;&gt;&gt; if not m.x:</span>
<span class="sd">    ...     pass</span>
<span class="sd">would cause this exception.&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__float__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__float__">[docs]</a>    <span class="k">def</span> <span class="fm">__float__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Coerce the value to a floating point</span>

<span class="sd">        Numeric values can be coerced to float only if the value /</span>
<span class="sd">        expression is constant.  Fixed (but non-constant) or variable</span>
<span class="sd">        values will raise an exception.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constant</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implicit conversion of Pyomo numeric value (%s) to float is disabled.</span>
<span class="sd">This error is often the result of using Pyomo components as arguments to</span>
<span class="sd">one of the Python built-in math module functions when defining</span>
<span class="sd">expressions. Avoid this error by using Pyomo-provided math functions or</span>
<span class="sd">explicitly resolving the numeric value using the Pyomo value() function.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__int__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__int__">[docs]</a>    <span class="k">def</span> <span class="fm">__int__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Coerce the value to an integer</span>

<span class="sd">        Numeric values can be coerced to int only if the value /</span>
<span class="sd">        expression is constant.  Fixed (but non-constant) or variable</span>
<span class="sd">        values will raise an exception.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constant</span><span class="p">():</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implicit conversion of Pyomo numeric value (%s) to int is disabled.</span>
<span class="sd">This error is often the result of using Pyomo components as arguments to</span>
<span class="sd">one of the Python built-in math module functions when defining</span>
<span class="sd">expressions. Avoid this error by using Pyomo-provided math functions or</span>
<span class="sd">explicitly resolving the numeric value using the Pyomo value() function.</span>
<span class="sd">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="p">,)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__lt__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__lt__">[docs]</a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Less than operator</span>

<span class="sd">        This method is called when Python processes statements of the form::</span>

<span class="sd">            self &lt; other</span>
<span class="sd">            other &gt; self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_generate_relational_expression</span><span class="p">(</span><span class="n">_lt</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__gt__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__gt__">[docs]</a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Greater than operator</span>

<span class="sd">        This method is called when Python processes statements of the form::</span>

<span class="sd">            self &gt; other</span>
<span class="sd">            other &lt; self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_generate_relational_expression</span><span class="p">(</span><span class="n">_lt</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__le__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__le__">[docs]</a>    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Less than or equal operator</span>

<span class="sd">        This method is called when Python processes statements of the form::</span>

<span class="sd">            self &lt;= other</span>
<span class="sd">            other &gt;= self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_generate_relational_expression</span><span class="p">(</span><span class="n">_le</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__ge__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__ge__">[docs]</a>    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Greater than or equal operator</span>

<span class="sd">        This method is called when Python processes statements of the form::</span>

<span class="sd">            self &gt;= other</span>
<span class="sd">            other &lt;= self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_generate_relational_expression</span><span class="p">(</span><span class="n">_le</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__eq__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equal to operator</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self == other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_generate_relational_expression</span><span class="p">(</span><span class="n">_eq</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__add__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__add__">[docs]</a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary addition</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self + other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_add_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__sub__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__sub__">[docs]</a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary subtraction</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self - other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__mul__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__mul__">[docs]</a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary multiplication</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self * other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_mul_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__div__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__div__">[docs]</a>    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary division</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self / other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__truediv__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__truediv__">[docs]</a>    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary division (when __future__.division is in effect)</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self / other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__pow__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__pow__">[docs]</a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary power</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self ** other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_pow_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__radd__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__radd__">[docs]</a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary addition</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other + self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_add_dispatcher</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__rsub__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__rsub__">[docs]</a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary subtraction</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other - self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">other</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__rmul__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__rmul__">[docs]</a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary multiplication</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other * self</span>

<span class="sd">        when other is not a :class:`NumericValue &lt;pyomo.core.expr.numvalue.NumericValue&gt;` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_mul_dispatcher</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__rdiv__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__rdiv__">[docs]</a>    <span class="k">def</span> <span class="nf">__rdiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Binary division</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other / self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__rtruediv__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__rtruediv__">[docs]</a>    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary division (when __future__.division is in effect)</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other / self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__rpow__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__rpow__">[docs]</a>    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary power</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            other ** self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_pow_dispatcher</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__iadd__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__iadd__">[docs]</a>    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary addition</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self += other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_add_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__isub__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__isub__">[docs]</a>    <span class="k">def</span> <span class="fm">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary subtraction</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self -= other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__imul__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__imul__">[docs]</a>    <span class="k">def</span> <span class="fm">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary multiplication</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self *= other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_mul_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__idiv__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__idiv__">[docs]</a>    <span class="k">def</span> <span class="nf">__idiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary division</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self /= other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__itruediv__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__itruediv__">[docs]</a>    <span class="k">def</span> <span class="fm">__itruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary division (when __future__.division is in effect)</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self /= other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_div_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__ipow__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__ipow__">[docs]</a>    <span class="k">def</span> <span class="fm">__ipow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary power</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            self **= other</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_pow_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__neg__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__neg__">[docs]</a>    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Negation</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            - self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_neg_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="NumericValue.__pos__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__pos__">[docs]</a>    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Positive expression</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            + self</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="NumericValue.__abs__"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.__abs__">[docs]</a>    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute value</span>

<span class="sd">        This method is called when Python processes the statement::</span>

<span class="sd">            abs(self)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_abs_dispatcher</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">](</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">NumericNDArray</span><span class="o">.</span><span class="n">__array_ufunc__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="NumericValue.to_string"><a class="viewcode-back" href="../../../../library_reference/expressions/classes.html#pyomo.core.expr.numvalue.NumericValue.to_string">[docs]</a>    <span class="k">def</span> <span class="nf">to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labeler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">smap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">compute_values</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a string representation of the expression tree.</span>

<span class="sd">        Args:</span>
<span class="sd">            verbose (bool): If :const:`True`, then the string</span>
<span class="sd">                representation consists of nested functions.  Otherwise,</span>
<span class="sd">                the string representation is an infix algebraic equation.</span>
<span class="sd">                Defaults to :const:`False`.</span>
<span class="sd">            labeler: An object that generates string labels for</span>
<span class="sd">                non-constant in the expression tree.  Defaults to</span>
<span class="sd">                :const:`None`.</span>
<span class="sd">            smap: A SymbolMap instance that stores string labels for</span>
<span class="sd">                non-constant nodes in the expression tree.  Defaults to</span>
<span class="sd">                :const:`None`.</span>
<span class="sd">            compute_values (bool): If :const:`True`, then fixed</span>
<span class="sd">                expressions are evaluated and the string representation</span>
<span class="sd">                of the resulting value is returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representation for the expression tree.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">compute_values</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fixed</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">())</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_constant</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">smap</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">smap</span><span class="o">.</span><span class="n">getSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labeler</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">labeler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">labeler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">NumericConstant</span><span class="p">(</span><span class="n">NumericValue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An object that contains a constant numeric value.</span>

<span class="sd">    Constructor Arguments:</span>
<span class="sd">        value           The initial value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">is_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">is_fixed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_compute_polynomial_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the constant value&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="nf">pprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ostream</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ostream</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma:nocover</span>
            <span class="n">ostream</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
        <span class="n">ostream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>


<span class="n">pyomo_constant_types</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">NumericConstant</span><span class="p">)</span>

<span class="c1"># We use as_numeric() so that the constant is also in the cache</span>
<span class="n">ZeroConstant</span> <span class="o">=</span> <span class="n">as_numeric</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="c1">#</span>
<span class="c1"># Note: the &quot;if numpy_available&quot; in the class definition also ensures</span>
<span class="c1"># that the numpy types are registered if numpy is in fact available</span>
<span class="c1">#</span>


<span class="k">class</span> <span class="nc">NumericNDArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="k">if</span> <span class="n">numpy_available</span> <span class="k">else</span> <span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An ndarray subclass that stores Pyomo numeric expressions&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;__call__&#39;</span><span class="p">:</span>
            <span class="c1"># Convert all incoming types to ndarray (to prevent recursion)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">]</span>
            <span class="c1"># Set the return type to be an &#39;object&#39;.  This prevents the</span>
            <span class="c1"># logical operators from casting the result to a bool.  This</span>
            <span class="c1"># requires numpy &gt;= 1.6</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">object</span>

        <span class="c1"># Delegate to the base ufunc, but return an instance of this</span>
        <span class="c1"># class so that additional operators hit this method.</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ans</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">ans</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">NumericNDArray</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ans</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2008-2023, Sandia National Laboratories.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>